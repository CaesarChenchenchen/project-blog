<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tianxiao Chen">
<meta name="dcterms.date" content="2023-04-25">

<title>quartoCourseBlog - San Francisco Crime Analysis in Physical and Social Environment</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">quartoCourseBlog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/CrumpLab/quartoCourseBlog" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/MattCrumpLab" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">San Francisco Crime Analysis in Physical and Social Environment</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">spatial</div>
                <div class="quarto-category">analysis</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Tianxiao Chen </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">April 25, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="environment-setting" class="level1">
<h1>Environment Setting</h1>
<section id="preparation-for-data-process" class="level3">
<h3 class="anchored" data-anchor-id="preparation-for-data-process">Preparation for data process</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data manipulation libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib <span class="im">as</span> mpl</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Timer</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm <span class="im">import</span> tqdm, tqdm_notebook</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Regression</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeRegressor</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestRegressor</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> AdaBoostRegressor</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> GradientBoostingRegressor</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> xgboost <span class="im">import</span> XGBRegressor </span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neural_network <span class="im">import</span> MLPRegressor</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsRegressor</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Model support functions</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> model_selection</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> PolynomialFeatures</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> cross_val_score</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> uniform</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler </span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pprint <span class="im">import</span> pprint</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.inspection <span class="im">import</span> permutation_importance</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error, mean_absolute_error, r2_score</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Geo-related libraries</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> folium</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> folium.plugins <span class="im">import</span> HeatMap</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopy</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> geopy.geocoders <span class="im">import</span> Nominatim</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> geopy.extra.rate_limiter <span class="im">import</span> RateLimiter</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> contextily <span class="im">as</span> ctx</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geofeather</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> geopandas <span class="im">import</span> GeoDataFrame</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> shapely.geometry <span class="im">import</span> Point</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> shapely <span class="im">import</span> wkt</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> shapely.geometry <span class="im">import</span> Point, MultiPoint</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> shapely.ops <span class="im">import</span> nearest_points</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> shapely <span class="im">import</span> wkt</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> osmnx</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pydrive.auth <span class="im">import</span> GoogleAuth</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pydrive.drive <span class="im">import</span> GoogleDrive</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> google.colab <span class="im">import</span> auth</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> oauth2client.client <span class="im">import</span> GoogleCredentials</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>auth.authenticate_user()</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>gauth <span class="op">=</span> GoogleAuth()</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>gauth.credentials <span class="op">=</span> GoogleCredentials.get_application_default()</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>drive <span class="op">=</span> GoogleDrive(gauth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#https://drive.google.com/file/d/1HJBU_-Yg_ylAzab8v11l1wcYEwBhO41-/view?usp=share_link</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="bu">id</span> <span class="op">=</span> <span class="st">"1HJBU_-Yg_ylAzab8v11l1wcYEwBhO41-"</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="bu">file</span> <span class="op">=</span> drive.CreateFile({<span class="st">'id'</span>:<span class="bu">id</span>}) </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="bu">file</span>.GetContentFile(<span class="st">'Police_Department_Incident_Reports__2018_to_Present.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data-brief-review" class="level3">
<h3 class="anchored" data-anchor-id="data-brief-review">Data brief review</h3>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:19059,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1681672850802,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="19da0cfa-c358-4708-8b03-033cc2bd5740">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#load crime data</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>crime_df <span class="op">=</span> pd.read_csv(<span class="st">'Police_Department_Incident_Reports__2018_to_Present.csv'</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>crime_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="7">

  <div id="df-143b3f54-a25e-4355-ae00-e78ae11a59ec">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Incident Datetime</th>
<th data-quarto-table-cell-role="th">Incident Date</th>
<th data-quarto-table-cell-role="th">Incident Time</th>
<th data-quarto-table-cell-role="th">Incident Year</th>
<th data-quarto-table-cell-role="th">Incident Day of Week</th>
<th data-quarto-table-cell-role="th">Report Datetime</th>
<th data-quarto-table-cell-role="th">Row ID</th>
<th data-quarto-table-cell-role="th">Incident ID</th>
<th data-quarto-table-cell-role="th">Incident Number</th>
<th data-quarto-table-cell-role="th">CAD Number</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Longitude</th>
<th data-quarto-table-cell-role="th">Point</th>
<th data-quarto-table-cell-role="th">Neighborhoods</th>
<th data-quarto-table-cell-role="th">ESNCAG - Boundary File</th>
<th data-quarto-table-cell-role="th">Central Market/Tenderloin Boundary Polygon - Updated</th>
<th data-quarto-table-cell-role="th">Civic Center Harm Reduction Project Boundary</th>
<th data-quarto-table-cell-role="th">HSOC Zones as of 2018-06-05</th>
<th data-quarto-table-cell-role="th">Invest In Neighborhoods (IIN) Areas</th>
<th data-quarto-table-cell-role="th">Current Supervisor Districts</th>
<th data-quarto-table-cell-role="th">Current Police Districts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2023/03/13 11:41:00 PM</td>
<td>2023/03/13</td>
<td>23:41</td>
<td>2023</td>
<td>Monday</td>
<td>2023/03/13 11:41:00 PM</td>
<td>125373607041</td>
<td>1253736</td>
<td>230167874</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2023/03/01 05:02:00 AM</td>
<td>2023/03/01</td>
<td>05:02</td>
<td>2023</td>
<td>Wednesday</td>
<td>2023/03/11 03:40:00 PM</td>
<td>125379506374</td>
<td>1253795</td>
<td>236046151</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2023/03/13 01:16:00 PM</td>
<td>2023/03/13</td>
<td>13:16</td>
<td>2023</td>
<td>Monday</td>
<td>2023/03/13 01:17:00 PM</td>
<td>125357107041</td>
<td>1253571</td>
<td>220343896</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2023/03/13 10:59:00 AM</td>
<td>2023/03/13</td>
<td>10:59</td>
<td>2023</td>
<td>Monday</td>
<td>2023/03/13 11:00:00 AM</td>
<td>125355107041</td>
<td>1253551</td>
<td>230174885</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2023/03/14 06:44:00 PM</td>
<td>2023/03/14</td>
<td>18:44</td>
<td>2023</td>
<td>Tuesday</td>
<td>2023/03/14 06:45:00 PM</td>
<td>125402407041</td>
<td>1254024</td>
<td>230176728</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>


<p>5 rows × 35 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-143b3f54-a25e-4355-ae00-e78ae11a59ec')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-143b3f54-a25e-4355-ae00-e78ae11a59ec button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-143b3f54-a25e-4355-ae00-e78ae11a59ec');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3040,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1681672853840,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="61199fe7-0c64-4ccb-91f6-c24277bfda4a">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>crime_df.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 716680 entries, 0 to 716679
Data columns (total 35 columns):
 #   Column                                                Non-Null Count   Dtype  
---  ------                                                --------------   -----  
 0   Incident Datetime                                     716680 non-null  object 
 1   Incident Date                                         716680 non-null  object 
 2   Incident Time                                         716680 non-null  object 
 3   Incident Year                                         716680 non-null  int64  
 4   Incident Day of Week                                  716680 non-null  object 
 5   Report Datetime                                       716680 non-null  object 
 6   Row ID                                                716680 non-null  int64  
 7   Incident ID                                           716680 non-null  int64  
 8   Incident Number                                       716680 non-null  int64  
 9   CAD Number                                            555602 non-null  float64
 10  Report Type Code                                      716680 non-null  object 
 11  Report Type Description                               716680 non-null  object 
 12  Filed Online                                          144690 non-null  object 
 13  Incident Code                                         716680 non-null  int64  
 14  Incident Category                                     716064 non-null  object 
 15  Incident Subcategory                                  716064 non-null  object 
 16  Incident Description                                  716680 non-null  object 
 17  Resolution                                            716680 non-null  object 
 18  Intersection                                          678513 non-null  object 
 19  CNN                                                   678513 non-null  float64
 20  Police District                                       716680 non-null  object 
 21  Analysis Neighborhood                                 678381 non-null  object 
 22  Supervisor District                                   678138 non-null  float64
 23  Supervisor District 2012                              678393 non-null  float64
 24  Latitude                                              678513 non-null  float64
 25  Longitude                                             678513 non-null  float64
 26  Point                                                 678513 non-null  object 
 27  Neighborhoods                                         664168 non-null  float64
 28  ESNCAG - Boundary File                                7761 non-null    float64
 29  Central Market/Tenderloin Boundary Polygon - Updated  92127 non-null   float64
 30  Civic Center Harm Reduction Project Boundary          91531 non-null   float64
 31  HSOC Zones as of 2018-06-05                           149426 non-null  float64
 32  Invest In Neighborhoods (IIN) Areas                   0 non-null       float64
 33  Current Supervisor Districts                          678393 non-null  float64
 34  Current Police Districts                              677736 non-null  float64
dtypes: float64(14), int64(5), object(16)
memory usage: 191.4+ MB</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3815,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1681672857653,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="1b541c62-4fdb-4806-e8c7-318ec8236df0">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#convert the pandas file to geopandas file</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>crime_df_geo <span class="op">=</span> gpd.GeoDataFrame(crime_df, geometry<span class="op">=</span>gpd.points_from_xy(crime_df.Longitude, crime_df.Latitude), crs<span class="op">=</span>{<span class="st">'init'</span> :<span class="st">'epsg:4326'</span>})</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>crime_df_geo.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>/usr/local/lib/python3.9/dist-packages/pyproj/crs/crs.py:141: FutureWarning: '+init=&lt;authority&gt;:&lt;code&gt;' syntax is deprecated. '&lt;authority&gt;:&lt;code&gt;' is the preferred initialization method. When making the change, be mindful of axis order changes: https://pyproj4.github.io/pyproj/stable/gotchas.html#axis-order-changes-in-proj-6
  in_crs_string = _prepare_from_proj_string(in_crs_string)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'geopandas.geodataframe.GeoDataFrame'&gt;
RangeIndex: 716680 entries, 0 to 716679
Data columns (total 36 columns):
 #   Column                                                Non-Null Count   Dtype   
---  ------                                                --------------   -----   
 0   Incident Datetime                                     716680 non-null  object  
 1   Incident Date                                         716680 non-null  object  
 2   Incident Time                                         716680 non-null  object  
 3   Incident Year                                         716680 non-null  int64   
 4   Incident Day of Week                                  716680 non-null  object  
 5   Report Datetime                                       716680 non-null  object  
 6   Row ID                                                716680 non-null  int64   
 7   Incident ID                                           716680 non-null  int64   
 8   Incident Number                                       716680 non-null  int64   
 9   CAD Number                                            555602 non-null  float64 
 10  Report Type Code                                      716680 non-null  object  
 11  Report Type Description                               716680 non-null  object  
 12  Filed Online                                          144690 non-null  object  
 13  Incident Code                                         716680 non-null  int64   
 14  Incident Category                                     716064 non-null  object  
 15  Incident Subcategory                                  716064 non-null  object  
 16  Incident Description                                  716680 non-null  object  
 17  Resolution                                            716680 non-null  object  
 18  Intersection                                          678513 non-null  object  
 19  CNN                                                   678513 non-null  float64 
 20  Police District                                       716680 non-null  object  
 21  Analysis Neighborhood                                 678381 non-null  object  
 22  Supervisor District                                   678138 non-null  float64 
 23  Supervisor District 2012                              678393 non-null  float64 
 24  Latitude                                              678513 non-null  float64 
 25  Longitude                                             678513 non-null  float64 
 26  Point                                                 678513 non-null  object  
 27  Neighborhoods                                         664168 non-null  float64 
 28  ESNCAG - Boundary File                                7761 non-null    float64 
 29  Central Market/Tenderloin Boundary Polygon - Updated  92127 non-null   float64 
 30  Civic Center Harm Reduction Project Boundary          91531 non-null   float64 
 31  HSOC Zones as of 2018-06-05                           149426 non-null  float64 
 32  Invest In Neighborhoods (IIN) Areas                   0 non-null       float64 
 33  Current Supervisor Districts                          678393 non-null  float64 
 34  Current Police Districts                              677736 non-null  float64 
 35  geometry                                              716680 non-null  geometry
dtypes: float64(14), geometry(1), int64(5), object(16)
memory usage: 196.8+ MB</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:43388,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1681672901039,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="338c2f1d-58bd-4b01-e4d3-9f6295084f30">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#intial visualization</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">10</span>))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>crime_df_geo.to_crs(epsg<span class="op">=</span><span class="dv">3857</span>).plot(ax <span class="op">=</span> ax,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">12</span>),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                markersize<span class="op">=</span><span class="dv">40</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>               color<span class="op">=</span><span class="st">"black"</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>               edgecolor<span class="op">=</span><span class="st">"white"</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>               alpha<span class="op">=</span><span class="fl">0.8</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>               marker<span class="op">=</span><span class="st">"o"</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>            )<span class="op">;</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>ctx.add_basemap(ax, source<span class="op">=</span>ctx.providers.OpenStreetMap.Mapnik)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="505Final_files/figure-html/cell-8-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="prev-analysis" class="level1">
<h1>Prev Analysis</h1>
<section id="the-number-of-crime-in-different-categories" class="level3">
<h3 class="anchored" data-anchor-id="the-number-of-crime-in-different-categories">The number of crime in different categories</h3>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:128,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1681672904814,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="557a7f32-f821-4d59-8ef5-6b2af37bfca2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate the number of crime in different categories</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>q1 <span class="op">=</span> crime_df.groupby(<span class="st">'Incident Category'</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>q1 <span class="op">=</span> q1.sort_values(by<span class="op">=</span><span class="st">'count'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>q1.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="11">

  <div id="df-57d8ec21-64f3-4511-bb14-6248e94ee63d">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Incident Category</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>Larceny Theft</td>
<td>218642</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">29</td>
<td>Other Miscellaneous</td>
<td>49878</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">21</td>
<td>Malicious Mischief</td>
<td>48503</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Assault</td>
<td>43600</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26</td>
<td>Non-Criminal</td>
<td>42605</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>Burglary</td>
<td>40225</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>Motor Vehicle Theft</td>
<td>36698</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">33</td>
<td>Recovered Vehicle</td>
<td>27881</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>Fraud</td>
<td>22995</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20</td>
<td>Lost Property</td>
<td>20831</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-57d8ec21-64f3-4511-bb14-6248e94ee63d')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-57d8ec21-64f3-4511-bb14-6248e94ee63d button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-57d8ec21-64f3-4511-bb14-6248e94ee63d');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1513,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1681672906485,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="52345464-0004-4aa1-cf72-29b48aae1019">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#data visualization</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> q1.plot(kind <span class="op">=</span> <span class="st">'bar'</span>, x <span class="op">=</span> <span class="st">'Incident Category'</span> , y <span class="op">=</span> <span class="st">'count'</span>, logy <span class="op">=</span> <span class="va">True</span>, color <span class="op">=</span> <span class="st">'red'</span>, legend <span class="op">=</span> <span class="va">False</span>, align <span class="op">=</span> <span class="st">'center'</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'count'</span>,fontsize <span class="op">=</span> <span class="dv">12</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'category'</span>,fontsize <span class="op">=</span> <span class="dv">12</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>plt.xticks(fontsize<span class="op">=</span><span class="dv">5</span>, rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Number of crimes for different categories'</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>display()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 640x480 with 0 Axes&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="505Final_files/figure-html/cell-10-output-2.png" class="img-fluid"></p>
</div>
</div>
<section id="from-the-number-of-crime-in-different-categories-we-can-find-that-larceny-theft-top-the-rank-and-significantly-outnumber-other-kinds-folliwing-malicious-mischief-and-assault.-the-large-number-of-theft-for-one-things-results-from-the-many-places-where-it-can-happen.-for-another-the-change-in-califonia-policy-for-the-determination-of-crime-also-lower-cost-of-crime-that-causes-lower-property-damage." class="level4">
<h4 class="anchored" data-anchor-id="from-the-number-of-crime-in-different-categories-we-can-find-that-larceny-theft-top-the-rank-and-significantly-outnumber-other-kinds-folliwing-malicious-mischief-and-assault.-the-large-number-of-theft-for-one-things-results-from-the-many-places-where-it-can-happen.-for-another-the-change-in-califonia-policy-for-the-determination-of-crime-also-lower-cost-of-crime-that-causes-lower-property-damage.">From the number of crime in different categories, we can find that ‘Larceny Theft’ top the rank and significantly outnumber other kinds, folliwing ‘Malicious Mischief’ and ‘Assault’. the large number of theft, for one things, results from the many places where it can happen. For another, the change in Califonia policy for the determination of crime also lower cost of crime that causes lower property damage.</h4>
</section>
</section>
<section id="the-number-of-crime-in-different-pddistricts" class="level3">
<h3 class="anchored" data-anchor-id="the-number-of-crime-in-different-pddistricts">The number of crime in different PdDistricts</h3>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:6,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1681672906486,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="a28c5fb1-997a-4993-8c69-749dd48fdc40">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate the number of crime in different PdDistricts</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>q2 <span class="op">=</span> crime_df.groupby(<span class="st">'Police District'</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>q2 <span class="op">=</span> q2.sort_values(by<span class="op">=</span><span class="st">'count'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>q2.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="13">

  <div id="df-b4331496-f77d-46ba-b3d9-c3b8208e0544">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Police District</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>Central</td>
<td>107239</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>Northern</td>
<td>97302</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>Mission</td>
<td>89637</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>Southern</td>
<td>86064</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>Tenderloin</td>
<td>69222</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>Bayview</td>
<td>63678</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Ingleside</td>
<td>54276</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>Taraval</td>
<td>50327</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>Richmond</td>
<td>44702</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>Park</td>
<td>32995</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-b4331496-f77d-46ba-b3d9-c3b8208e0544')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-b4331496-f77d-46ba-b3d9-c3b8208e0544 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-b4331496-f77d-46ba-b3d9-c3b8208e0544');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:453,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1681672906934,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="e21409b3-8f02-43cb-85bf-a7388a73c918">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#data visualization</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> q2.plot(kind <span class="op">=</span> <span class="st">'bar'</span>, x <span class="op">=</span> <span class="st">'Police District'</span> , y <span class="op">=</span> <span class="st">'count'</span>, logy <span class="op">=</span> <span class="va">True</span>, color <span class="op">=</span> <span class="st">'yellow'</span>, legend <span class="op">=</span> <span class="va">False</span>, align <span class="op">=</span> <span class="st">'center'</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'count'</span>,fontsize <span class="op">=</span> <span class="dv">12</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'PdDistrict'</span>,fontsize <span class="op">=</span> <span class="dv">12</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>plt.xticks(fontsize<span class="op">=</span><span class="dv">5</span>, rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Number of crimes in different PdDistricts'</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>display()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 640x480 with 0 Axes&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="505Final_files/figure-html/cell-12-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="the-trend-of-number-of-crime-from-2018-to-2022" class="level3">
<h3 class="anchored" data-anchor-id="the-trend-of-number-of-crime-from-2018-to-2022">The trend of number of crime from 2018 to 2022</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># switch the form of time data for easier analysis </span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>crime_df[[<span class="st">'year'</span>,<span class="st">'month'</span>, <span class="st">'day'</span>]] <span class="op">=</span> crime_df[<span class="st">'Incident Date'</span>].<span class="bu">str</span>.split(<span class="st">'/'</span>, expand<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>crime_df[<span class="st">'day'</span>] <span class="op">=</span> pd.to_numeric(crime_df[<span class="st">'day'</span>])</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>crime_df[<span class="st">'month'</span>] <span class="op">=</span> pd.to_numeric(crime_df[<span class="st">'month'</span>])</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>crime_df[<span class="st">'year'</span>] <span class="op">=</span> pd.to_numeric(crime_df[<span class="st">'year'</span>])</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>crime_df[[<span class="st">'hour'</span>,<span class="st">'minute'</span>]] <span class="op">=</span> crime_df[<span class="st">'Incident Time'</span>].<span class="bu">str</span>.split(<span class="st">':'</span>, expand<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>crime_df[<span class="st">'hour'</span>] <span class="op">=</span> pd.to_numeric(crime_df[<span class="st">'hour'</span>])</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>crime_df[<span class="st">'minute'</span>] <span class="op">=</span> pd.to_numeric(crime_df[<span class="st">'minute'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:279,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1681672912720,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="c76efb64-583e-4c66-cc12-f430ab45dd15">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#select the data from 2018 to 2022</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>year <span class="op">=</span> [<span class="dv">2018</span>,<span class="dv">2019</span>,<span class="dv">2020</span>,<span class="dv">2021</span>,<span class="dv">2022</span>]</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>crime_df_new <span class="op">=</span> crime_df[crime_df.year.isin(year)]</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>crime_df_new.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="16">

  <div id="df-b45dd8c6-39d7-47e0-98d9-d52b2c876c7c">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Incident Datetime</th>
<th data-quarto-table-cell-role="th">Incident Date</th>
<th data-quarto-table-cell-role="th">Incident Time</th>
<th data-quarto-table-cell-role="th">Incident Year</th>
<th data-quarto-table-cell-role="th">Incident Day of Week</th>
<th data-quarto-table-cell-role="th">Report Datetime</th>
<th data-quarto-table-cell-role="th">Row ID</th>
<th data-quarto-table-cell-role="th">Incident ID</th>
<th data-quarto-table-cell-role="th">Incident Number</th>
<th data-quarto-table-cell-role="th">CAD Number</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">HSOC Zones as of 2018-06-05</th>
<th data-quarto-table-cell-role="th">Invest In Neighborhoods (IIN) Areas</th>
<th data-quarto-table-cell-role="th">Current Supervisor Districts</th>
<th data-quarto-table-cell-role="th">Current Police Districts</th>
<th data-quarto-table-cell-role="th">geometry</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">11</td>
<td>2022/06/27 12:00:00 PM</td>
<td>2022/06/27</td>
<td>12:00</td>
<td>2022</td>
<td>Monday</td>
<td>2023/03/15 05:20:00 PM</td>
<td>125439371000</td>
<td>1254393</td>
<td>230184129</td>
<td>230742480.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>3.0</td>
<td>6.0</td>
<td>POINT (-122.40823 37.78736)</td>
<td>2022</td>
<td>6</td>
<td>27</td>
<td>12</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25</td>
<td>2022/05/15 04:00:00 PM</td>
<td>2022/05/15</td>
<td>16:00</td>
<td>2022</td>
<td>Sunday</td>
<td>2022/05/17 07:32:00 PM</td>
<td>116100671000</td>
<td>1161006</td>
<td>226100018</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>POINT EMPTY</td>
<td>2022</td>
<td>5</td>
<td>15</td>
<td>16</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35</td>
<td>2018/09/03 09:00:00 AM</td>
<td>2018/09/03</td>
<td>09:00</td>
<td>2018</td>
<td>Monday</td>
<td>2018/09/03 01:17:00 PM</td>
<td>73006271000</td>
<td>730062</td>
<td>186245900</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>POINT EMPTY</td>
<td>2018</td>
<td>9</td>
<td>3</td>
<td>9</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">36</td>
<td>2019/01/13 02:00:00 PM</td>
<td>2019/01/13</td>
<td>14:00</td>
<td>2019</td>
<td>Sunday</td>
<td>2019/01/14 12:10:00 PM</td>
<td>75982071000</td>
<td>759820</td>
<td>196009821</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>POINT EMPTY</td>
<td>2019</td>
<td>1</td>
<td>13</td>
<td>14</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">37</td>
<td>2018/11/02 12:00:00 PM</td>
<td>2018/11/02</td>
<td>12:00</td>
<td>2018</td>
<td>Friday</td>
<td>2018/11/03 02:21:00 PM</td>
<td>73376171000</td>
<td>733761</td>
<td>180833020</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>POINT EMPTY</td>
<td>2018</td>
<td>11</td>
<td>2</td>
<td>12</td>
<td>0</td>
</tr>
</tbody>
</table>


<p>5 rows × 41 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-b45dd8c6-39d7-47e0-98d9-d52b2c876c7c')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-b45dd8c6-39d7-47e0-98d9-d52b2c876c7c button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-b45dd8c6-39d7-47e0-98d9-d52b2c876c7c');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:168,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1681672912884,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="154b2afd-30ae-4b29-e06b-806b2b229a6b">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the monthly number of crime from 2018 to 2022 </span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>q3 <span class="op">=</span> crime_df_new.groupby([<span class="st">'year'</span>,<span class="st">'month'</span>]).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>q3 <span class="op">=</span> q3.sort_values(by<span class="op">=</span>[<span class="st">'year'</span>,<span class="st">'month'</span>], ascending<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>q3[<span class="st">'year-month'</span>] <span class="op">=</span> q3[<span class="st">'year'</span>].astype(<span class="bu">str</span>) <span class="op">+</span> <span class="st">'-'</span> <span class="op">+</span> q3[<span class="st">'month'</span>].astype(<span class="bu">str</span>).<span class="bu">str</span>.zfill(<span class="dv">2</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>q3.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="17">

  <div id="df-73d930f2-970f-4aa0-bdcf-420a9e6164bc">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">year-month</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2018</td>
<td>1</td>
<td>13274</td>
<td>2018-01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2018</td>
<td>2</td>
<td>11727</td>
<td>2018-02</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2018</td>
<td>3</td>
<td>12565</td>
<td>2018-03</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2018</td>
<td>4</td>
<td>12421</td>
<td>2018-04</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2018</td>
<td>5</td>
<td>12847</td>
<td>2018-05</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-73d930f2-970f-4aa0-bdcf-420a9e6164bc')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-73d930f2-970f-4aa0-bdcf-420a9e6164bc button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-73d930f2-970f-4aa0-bdcf-420a9e6164bc');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1490,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1681672914373,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="36a05c8d-08d9-4dfd-856b-78f4c2030c3b">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#data visualization</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> q3.plot(kind <span class="op">=</span> <span class="st">'bar'</span>, x <span class="op">=</span> <span class="st">'year-month'</span> , y <span class="op">=</span> <span class="st">'count'</span>, logy <span class="op">=</span> <span class="va">True</span>, color <span class="op">=</span> <span class="st">'yellow'</span>, legend <span class="op">=</span> <span class="va">False</span>, align <span class="op">=</span> <span class="st">'center'</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'count'</span>,fontsize <span class="op">=</span> <span class="dv">12</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'PdDistrict'</span>,fontsize <span class="op">=</span> <span class="dv">12</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>plt.xticks(fontsize<span class="op">=</span><span class="dv">5</span>, rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Change in number of crime from 2018 to 2022'</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>display()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 640x480 with 0 Axes&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="505Final_files/figure-html/cell-16-output-2.png" class="img-fluid"></p>
</div>
</div>
<section id="from-the-bar-chart-of-crime-number-based-on-the-month-first-of-all-we-can-find-that-the-crime-nunmber-show-a-seasonality-which-increase-from-every-years-march-and-reach-a-peak-in-september-and-then-drop-till-next-years-march.-also-we-can-find-a-sharp-decrease-at-the-begining-of-2020.-we-can-assume-that-this-situation-was-highly-influenced-by-covid-19-and-the-influence-is-gradually-weakened-after-begining-of-2020-but-count-of-crime-is-less-than-pre-covid-anually." class="level4">
<h4 class="anchored" data-anchor-id="from-the-bar-chart-of-crime-number-based-on-the-month-first-of-all-we-can-find-that-the-crime-nunmber-show-a-seasonality-which-increase-from-every-years-march-and-reach-a-peak-in-september-and-then-drop-till-next-years-march.-also-we-can-find-a-sharp-decrease-at-the-begining-of-2020.-we-can-assume-that-this-situation-was-highly-influenced-by-covid-19-and-the-influence-is-gradually-weakened-after-begining-of-2020-but-count-of-crime-is-less-than-pre-covid-anually.">From the bar chart of crime number based on the month, first of all, we can find that the crime nunmber show a seasonality, which increase from every year’s March and reach a peak in September and then drop till next year’s March. Also, we can find a sharp decrease at the begining of 2020. We can assume that this situation was highly influenced by Covid-19, and the influence is gradually weakened after begining of 2020 but count of crime is less than pre-covid anually.</h4>
</section>
</section>
<section id="the-hourly-distribution-of-crime-in-a-day" class="level3">
<h3 class="anchored" data-anchor-id="the-hourly-distribution-of-crime-in-a-day">The hourly distribution of crime in a day?</h3>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:4,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1681672914374,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="7a301568-6b89-47cb-903e-26fa0e133283">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count the number of crime in different hours</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>q4 <span class="op">=</span> crime_df_new.groupby(<span class="st">'hour'</span>).size().reset_index(name <span class="op">=</span> <span class="st">'count'</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>q4 <span class="op">=</span> q4.sort_values(by<span class="op">=</span><span class="st">'hour'</span>, ascending<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>q4.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="19">

  <div id="df-65c0a016-741f-4066-b202-200f3f9306c8">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>37081</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>18247</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>15878</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>12917</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>10887</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-65c0a016-741f-4066-b202-200f3f9306c8')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-65c0a016-741f-4066-b202-200f3f9306c8 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-65c0a016-741f-4066-b202-200f3f9306c8');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:781,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1681672915152,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="d4c9cb0a-6788-402f-bfc3-2c8862d29544">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#chart visualization</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> q4.plot(kind <span class="op">=</span> <span class="st">'bar'</span>, x <span class="op">=</span> <span class="st">'hour'</span> , y <span class="op">=</span> <span class="st">'count'</span>, logy <span class="op">=</span> <span class="va">True</span>, color <span class="op">=</span> <span class="st">'blue'</span>, legend <span class="op">=</span> <span class="va">False</span>, align <span class="op">=</span> <span class="st">'center'</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'count'</span>,fontsize <span class="op">=</span> <span class="dv">12</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Hour'</span>,fontsize <span class="op">=</span> <span class="dv">12</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>plt.xticks(fontsize<span class="op">=</span><span class="dv">5</span>, rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Time distribution in a day of crime from 2018 to 2022'</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>display()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 640x480 with 0 Axes&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="505Final_files/figure-html/cell-18-output-2.png" class="img-fluid"></p>
</div>
</div>
<section id="from-the-number-of-crime-change-in-a-day-we-can-find-that-the-frequency-of-crime-have-three-peaks-in-a-day-12am-12pm-and-18pm.-the-peak-time-in-12am-and-18pm-can-be-explained-by-the-huge-footfall-during-that-time.-however-the-phenomenon-that-sudden-increase-in-the-12am-and-sharply-drop-after-that-time-is-hard-to-explained." class="level4">
<h4 class="anchored" data-anchor-id="from-the-number-of-crime-change-in-a-day-we-can-find-that-the-frequency-of-crime-have-three-peaks-in-a-day-12am-12pm-and-18pm.-the-peak-time-in-12am-and-18pm-can-be-explained-by-the-huge-footfall-during-that-time.-however-the-phenomenon-that-sudden-increase-in-the-12am-and-sharply-drop-after-that-time-is-hard-to-explained.">From the number of crime change in a day, we can find that the frequency of crime have three peaks in a day: 12AM, 12PM, and 18PM. The peak time in 12AM and 18PM can be explained by the huge footfall during that time. However, the phenomenon that sudden increase in the 12AM and sharply drop after that time is hard to explained.</h4>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:158,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1681672915308,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="b9231c1c-81f1-47e8-bdd7-929fe1a5f5eb">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#check the hourly distribution for different types of crime</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>q5 <span class="op">=</span> crime_df_new.groupby([<span class="st">'hour'</span>,<span class="st">'Incident Category'</span>]).size().reset_index(name <span class="op">=</span> <span class="st">'count'</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>q5 <span class="op">=</span> q5.sort_values(by<span class="op">=</span><span class="st">'count'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>q5.head(<span class="dv">24</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="21">

  <div id="df-4f2ac29c-fe73-456b-aba1-8a5a010b5ac2">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">Incident Category</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">841</td>
<td>18</td>
<td>Larceny Theft</td>
<td>15632</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">887</td>
<td>19</td>
<td>Larceny Theft</td>
<td>14667</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">556</td>
<td>12</td>
<td>Larceny Theft</td>
<td>14128</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">794</td>
<td>17</td>
<td>Larceny Theft</td>
<td>13798</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">932</td>
<td>20</td>
<td>Larceny Theft</td>
<td>13176</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">510</td>
<td>11</td>
<td>Larceny Theft</td>
<td>12020</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">746</td>
<td>16</td>
<td>Larceny Theft</td>
<td>11591</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">698</td>
<td>15</td>
<td>Larceny Theft</td>
<td>11536</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">603</td>
<td>13</td>
<td>Larceny Theft</td>
<td>11491</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">650</td>
<td>14</td>
<td>Larceny Theft</td>
<td>11245</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">979</td>
<td>21</td>
<td>Larceny Theft</td>
<td>10208</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">463</td>
<td>10</td>
<td>Larceny Theft</td>
<td>9859</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>0</td>
<td>Larceny Theft</td>
<td>9570</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1026</td>
<td>22</td>
<td>Larceny Theft</td>
<td>8337</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">417</td>
<td>9</td>
<td>Larceny Theft</td>
<td>7121</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1073</td>
<td>23</td>
<td>Larceny Theft</td>
<td>6780</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">371</td>
<td>8</td>
<td>Larceny Theft</td>
<td>5897</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">65</td>
<td>1</td>
<td>Larceny Theft</td>
<td>4951</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>0</td>
<td>Fraud</td>
<td>4652</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">328</td>
<td>7</td>
<td>Larceny Theft</td>
<td>3591</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">111</td>
<td>2</td>
<td>Larceny Theft</td>
<td>3414</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">552</td>
<td>12</td>
<td>Fraud</td>
<td>3185</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">844</td>
<td>18</td>
<td>Malicious Mischief</td>
<td>2990</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">757</td>
<td>16</td>
<td>Other Miscellaneous</td>
<td>2905</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-4f2ac29c-fe73-456b-aba1-8a5a010b5ac2')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-4f2ac29c-fe73-456b-aba1-8a5a010b5ac2 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-4f2ac29c-fe73-456b-aba1-8a5a010b5ac2');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:5,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1681672915309,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="5e50ee6d-7fe1-4371-a49f-adf99b79e6d0">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#check the hourly distribution for the 'Larceny Theft' category</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>q5_theft <span class="op">=</span> q5[q5[<span class="st">'Incident Category'</span>].isin([<span class="st">'Larceny Theft'</span>])]</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>q5_theft <span class="op">=</span> q5_theft.sort_values(by <span class="op">=</span> <span class="st">'hour'</span>,ascending <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>q5_theft.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="22">

  <div id="df-9183a0ca-ce09-4549-ac01-3d857c2f8f27">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">Incident Category</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>0</td>
<td>Larceny Theft</td>
<td>9570</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">65</td>
<td>1</td>
<td>Larceny Theft</td>
<td>4951</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">111</td>
<td>2</td>
<td>Larceny Theft</td>
<td>3414</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">153</td>
<td>3</td>
<td>Larceny Theft</td>
<td>2746</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">198</td>
<td>4</td>
<td>Larceny Theft</td>
<td>2175</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-9183a0ca-ce09-4549-ac01-3d857c2f8f27')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-9183a0ca-ce09-4549-ac01-3d857c2f8f27 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-9183a0ca-ce09-4549-ac01-3d857c2f8f27');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1019,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1681672916324,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="0ca6b202-122f-4427-bdb2-004ab066befe">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#data visualization</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> q5_theft.plot(kind <span class="op">=</span> <span class="st">'bar'</span>, x <span class="op">=</span> <span class="st">'hour'</span> , y <span class="op">=</span> <span class="st">'count'</span>, logy <span class="op">=</span> <span class="va">True</span>, color <span class="op">=</span> <span class="st">'blue'</span>, legend <span class="op">=</span> <span class="va">False</span>, align <span class="op">=</span> <span class="st">'center'</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'count'</span>,fontsize <span class="op">=</span> <span class="dv">12</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Hour'</span>,fontsize <span class="op">=</span> <span class="dv">12</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>plt.xticks(fontsize<span class="op">=</span><span class="dv">5</span>, rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Time distribution in a day of theft from 2018 to 2022'</span>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>display()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 640x480 with 0 Axes&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="505Final_files/figure-html/cell-21-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="the-resolution-situation-of-crime-in-different-categories" class="level3">
<h3 class="anchored" data-anchor-id="the-resolution-situation-of-crime-in-different-categories">The Resolution situation of crime in different categories</h3>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1784,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1681672918106,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="c964bc63-cd81-42a3-a1dd-b446b8f7906f">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#create dummy variables based on the 'resolution' column </span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>crime_df_new[<span class="st">'Resolution'</span>].unique()</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>crime_df_new[<span class="st">'Result'</span>] <span class="op">=</span> np.where(crime_df_new[<span class="st">'Resolution'</span>] <span class="op">==</span> <span class="st">'Open or Active'</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>crime_df_new.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  crime_df_new['Result'] = np.where(crime_df_new['Resolution'] == 'Open or Active', 0, 1)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 682474 entries, 11 to 716671
Data columns (total 42 columns):
 #   Column                                                Non-Null Count   Dtype   
---  ------                                                --------------   -----   
 0   Incident Datetime                                     682474 non-null  object  
 1   Incident Date                                         682474 non-null  object  
 2   Incident Time                                         682474 non-null  object  
 3   Incident Year                                         682474 non-null  int64   
 4   Incident Day of Week                                  682474 non-null  object  
 5   Report Datetime                                       682474 non-null  object  
 6   Row ID                                                682474 non-null  int64   
 7   Incident ID                                           682474 non-null  int64   
 8   Incident Number                                       682474 non-null  int64   
 9   CAD Number                                            528524 non-null  float64 
 10  Report Type Code                                      682474 non-null  object  
 11  Report Type Description                               682474 non-null  object  
 12  Filed Online                                          138643 non-null  object  
 13  Incident Code                                         682474 non-null  int64   
 14  Incident Category                                     681904 non-null  object  
 15  Incident Subcategory                                  681904 non-null  object  
 16  Incident Description                                  682474 non-null  object  
 17  Resolution                                            682474 non-null  object  
 18  Intersection                                          646095 non-null  object  
 19  CNN                                                   646095 non-null  float64 
 20  Police District                                       682474 non-null  object  
 21  Analysis Neighborhood                                 645967 non-null  object  
 22  Supervisor District                                   645740 non-null  float64 
 23  Supervisor District 2012                              645980 non-null  float64 
 24  Latitude                                              646095 non-null  float64 
 25  Longitude                                             646095 non-null  float64 
 26  Point                                                 646095 non-null  object  
 27  Neighborhoods                                         632302 non-null  float64 
 28  ESNCAG - Boundary File                                7453 non-null    float64 
 29  Central Market/Tenderloin Boundary Polygon - Updated  87260 non-null   float64 
 30  Civic Center Harm Reduction Project Boundary          86966 non-null   float64 
 31  HSOC Zones as of 2018-06-05                           142555 non-null  float64 
 32  Invest In Neighborhoods (IIN) Areas                   0 non-null       float64 
 33  Current Supervisor Districts                          645980 non-null  float64 
 34  Current Police Districts                              645342 non-null  float64 
 35  geometry                                              682474 non-null  geometry
 36  year                                                  682474 non-null  int64   
 37  month                                                 682474 non-null  int64   
 38  day                                                   682474 non-null  int64   
 39  hour                                                  682474 non-null  int64   
 40  minute                                                682474 non-null  int64   
 41  Result                                                682474 non-null  int64   
dtypes: float64(14), geometry(1), int64(11), object(16)
memory usage: 223.9+ MB</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:180,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1681672918284,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="5af8d9dd-a7a2-44e5-e3a5-897dda9cc3ec">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the number of different kinds of crime that got resolution</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>q6 <span class="op">=</span> crime_df_new.groupby([<span class="st">'Incident Category'</span>,<span class="st">'Result'</span>]).size().reset_index(name <span class="op">=</span> <span class="st">'count'</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>q6 <span class="op">=</span> q6.sort_values(by <span class="op">=</span> <span class="st">'Incident Category'</span>, ascending <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>q6.head()</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>q6_solve <span class="op">=</span> q6[q6.Result <span class="op">==</span> <span class="dv">1</span>]</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>q6_solve.head()</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># merge the chart with number of crime to calculate the reolution rate</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>q6_merge <span class="op">=</span> pd.merge(q6_solve, q1, on<span class="op">=</span><span class="st">'Incident Category'</span>)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>q6_merge[<span class="st">'solve_rate'</span>] <span class="op">=</span> q6_merge.count_x<span class="op">/</span>q6_merge.count_y</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>q6_merge.sort_values(by <span class="op">=</span> <span class="st">'solve_rate'</span>, ascending <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="25">

  <div id="df-aa7ac51d-c494-4ceb-9c3d-b68b8059e215">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Incident Category</th>
<th data-quarto-table-cell-role="th">Result</th>
<th data-quarto-table-cell-role="th">count_x</th>
<th data-quarto-table-cell-role="th">count_y</th>
<th data-quarto-table-cell-role="th">solve_rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">19</td>
<td>Lost Property</td>
<td>1</td>
<td>79</td>
<td>20831</td>
<td>0.003792</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27</td>
<td>Other</td>
<td>1</td>
<td>67</td>
<td>5831</td>
<td>0.011490</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">36</td>
<td>Suicide</td>
<td>1</td>
<td>7</td>
<td>324</td>
<td>0.021605</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">37</td>
<td>Suspicious</td>
<td>1</td>
<td>3</td>
<td>102</td>
<td>0.029412</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">38</td>
<td>Suspicious Occ</td>
<td>1</td>
<td>474</td>
<td>14652</td>
<td>0.032351</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>Fire Report</td>
<td>1</td>
<td>35</td>
<td>1052</td>
<td>0.033270</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17</td>
<td>Larceny Theft</td>
<td>1</td>
<td>7836</td>
<td>218642</td>
<td>0.035839</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>Fraud</td>
<td>1</td>
<td>955</td>
<td>22995</td>
<td>0.041531</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>Missing Person</td>
<td>1</td>
<td>697</td>
<td>15462</td>
<td>0.045078</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>Motor Vehicle Theft</td>
<td>1</td>
<td>1811</td>
<td>36698</td>
<td>0.049349</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">21</td>
<td>Miscellaneous Investigation</td>
<td>1</td>
<td>409</td>
<td>7457</td>
<td>0.054848</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Courtesy Report</td>
<td>1</td>
<td>156</td>
<td>2101</td>
<td>0.074250</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">32</td>
<td>Recovered Vehicle</td>
<td>1</td>
<td>2745</td>
<td>27881</td>
<td>0.098454</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20</td>
<td>Malicious Mischief</td>
<td>1</td>
<td>5109</td>
<td>48503</td>
<td>0.105334</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">31</td>
<td>Rape</td>
<td>1</td>
<td>19</td>
<td>172</td>
<td>0.110465</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25</td>
<td>Non-Criminal</td>
<td>1</td>
<td>4790</td>
<td>42605</td>
<td>0.112428</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Burglary</td>
<td>1</td>
<td>4617</td>
<td>40225</td>
<td>0.114779</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>Embezzlement</td>
<td>1</td>
<td>124</td>
<td>927</td>
<td>0.133765</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">33</td>
<td>Robbery</td>
<td>1</td>
<td>2986</td>
<td>15998</td>
<td>0.186648</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>Arson</td>
<td>1</td>
<td>450</td>
<td>2052</td>
<td>0.219298</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">41</td>
<td>Vandalism</td>
<td>1</td>
<td>389</td>
<td>1534</td>
<td>0.253585</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">29</td>
<td>Other Offenses</td>
<td>1</td>
<td>1654</td>
<td>6053</td>
<td>0.273253</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11</td>
<td>Forgery And Counterfeiting</td>
<td>1</td>
<td>684</td>
<td>2461</td>
<td>0.277936</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>Disorderly Conduct</td>
<td>1</td>
<td>3325</td>
<td>11771</td>
<td>0.282474</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>Assault</td>
<td>1</td>
<td>12399</td>
<td>43600</td>
<td>0.284381</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">47</td>
<td>Weapons Offense</td>
<td>1</td>
<td>1653</td>
<td>4893</td>
<td>0.337830</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26</td>
<td>Offences Against The Family And Children</td>
<td>1</td>
<td>3352</td>
<td>9862</td>
<td>0.339890</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">43</td>
<td>Vehicle Misplaced</td>
<td>1</td>
<td>104</td>
<td>297</td>
<td>0.350168</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">42</td>
<td>Vehicle Impounded</td>
<td>1</td>
<td>180</td>
<td>472</td>
<td>0.381356</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16</td>
<td>Human Trafficking, Commercial Sex Acts</td>
<td>1</td>
<td>9</td>
<td>22</td>
<td>0.409091</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">39</td>
<td>Traffic Collision</td>
<td>1</td>
<td>739</td>
<td>1663</td>
<td>0.444378</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">28</td>
<td>Other Miscellaneous</td>
<td>1</td>
<td>26580</td>
<td>49878</td>
<td>0.532900</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>Homicide</td>
<td>1</td>
<td>61</td>
<td>106</td>
<td>0.575472</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">34</td>
<td>Sex Offense</td>
<td>1</td>
<td>445</td>
<td>746</td>
<td>0.596515</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15</td>
<td>Human Trafficking (A), Commercial Sex Acts</td>
<td>1</td>
<td>78</td>
<td>130</td>
<td>0.600000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>Gambling</td>
<td>1</td>
<td>20</td>
<td>33</td>
<td>0.606061</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>Motor Vehicle Theft?</td>
<td>1</td>
<td>47</td>
<td>74</td>
<td>0.635135</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>Civil Sidewalks</td>
<td>1</td>
<td>638</td>
<td>888</td>
<td>0.718468</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>Liquor Laws</td>
<td>1</td>
<td>57</td>
<td>77</td>
<td>0.740260</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35</td>
<td>Stolen Property</td>
<td>1</td>
<td>2853</td>
<td>3563</td>
<td>0.800730</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">45</td>
<td>Weapons Carrying Etc</td>
<td>1</td>
<td>3498</td>
<td>4081</td>
<td>0.857143</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Drug Offense</td>
<td>1</td>
<td>15127</td>
<td>17606</td>
<td>0.859196</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">30</td>
<td>Prostitution</td>
<td>1</td>
<td>811</td>
<td>941</td>
<td>0.861849</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">46</td>
<td>Weapons Offence</td>
<td>1</td>
<td>19</td>
<td>21</td>
<td>0.904762</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">44</td>
<td>Warrant</td>
<td>1</td>
<td>18952</td>
<td>20713</td>
<td>0.914981</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>Drug Violation</td>
<td>1</td>
<td>228</td>
<td>249</td>
<td>0.915663</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">40</td>
<td>Traffic Violation Arrest</td>
<td>1</td>
<td>6413</td>
<td>6890</td>
<td>0.930769</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Case Closure</td>
<td>1</td>
<td>2804</td>
<td>2929</td>
<td>0.957323</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-aa7ac51d-c494-4ceb-9c3d-b68b8059e215')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-aa7ac51d-c494-4ceb-9c3d-b68b8059e215 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-aa7ac51d-c494-4ceb-9c3d-b68b8059e215');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<section id="from-the-resolution-rate-of-different-kinds-of-crime-we-can-also-find-that-the-top-number-of-crime-category-also-have-a-low-resolution-rate.-larceny-theft-only-has-3-resolution-rate-while-marlicious-mischief-has-10-resolution-rate.-we-can-conclude-that-the-crime-that-people-are-most-likely-to-confront-in-the-daily-life-still-have-a-huge-influence-on-city-life.-therefore-its-necessary-to-perform-a-deeper-analysis-on-which-factor-influence-the-conduct-of-crime." class="level4">
<h4 class="anchored" data-anchor-id="from-the-resolution-rate-of-different-kinds-of-crime-we-can-also-find-that-the-top-number-of-crime-category-also-have-a-low-resolution-rate.-larceny-theft-only-has-3-resolution-rate-while-marlicious-mischief-has-10-resolution-rate.-we-can-conclude-that-the-crime-that-people-are-most-likely-to-confront-in-the-daily-life-still-have-a-huge-influence-on-city-life.-therefore-its-necessary-to-perform-a-deeper-analysis-on-which-factor-influence-the-conduct-of-crime.">From the resolution rate of different kinds of crime, we can also find that the top number of crime category also have a low resolution rate. ‘Larceny Theft’ only has 3% resolution rate, while ‘Marlicious Mischief’ has 10% resolution rate. We can conclude that the crime that people are most likely to confront in the daily life still have a huge influence on city life. Therefore, it’s necessary to perform a deeper analysis on which factor influence the conduct of crime.</h4>
</section>
</section>
</section>
<section id="combine-crime-data-with-social-ecnomic-data-and-zoning-construction-data" class="level1">
<h1>Combine crime data with social-ecnomic data and Zoning &amp; Construction data</h1>
<section id="clean-the-crime-data" class="level2">
<h2 class="anchored" data-anchor-id="clean-the-crime-data">clean the crime data</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#clean the crime dataset</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>crime_df_copy <span class="op">=</span> crime_df_new.copy()</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>drop <span class="op">=</span> [<span class="st">'Incident Datetime'</span>,<span class="st">'Incident Date'</span>,<span class="st">'Report Datetime'</span>,<span class="st">'Row ID'</span>,<span class="st">'Incident ID'</span>,<span class="st">'Incident Number'</span>,<span class="st">'CAD Number'</span>,<span class="st">'Report Type Description'</span>,<span class="st">'Filed Online'</span>,<span class="st">'Incident Code'</span>,<span class="st">'Incident Description'</span>,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CNN'</span>,<span class="st">'Supervisor District'</span>,<span class="st">'Central Market/Tenderloin Boundary Polygon - Updated'</span>,<span class="st">'Civic Center Harm Reduction Project Boundary'</span>,<span class="st">'HSOC Zones as of 2018-06-05'</span>,<span class="st">'Invest In Neighborhoods (IIN) Areas'</span>,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Current Supervisor Districts'</span>,<span class="st">'Current Police Districts'</span>]</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>crime_df_drop <span class="op">=</span> crime_df_copy.drop(columns <span class="op">=</span> drop)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>crime_df_drop.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#select the theft type data in 2020</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>crime_df_drop <span class="op">=</span> crime_df_drop[crime_df_drop.year <span class="op">==</span> <span class="dv">2020</span>]</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>crime_df_drop <span class="op">=</span> crime_df_drop[crime_df_drop[<span class="st">'Incident Category'</span>] <span class="op">==</span> <span class="st">'Larceny Theft'</span>]</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>crime_df_drop.reset_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#get the geo boundary of San Francisco</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>sf_poly <span class="op">=</span> osmnx.geocode_to_gdf(<span class="st">'San Francisco, CA, USA'</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>sf_poly.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#convert to geopandas file</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>gpd_crime <span class="op">=</span> gpd.GeoDataFrame(crime_df_drop, geometry <span class="op">=</span> crime_df_drop[<span class="st">'geometry'</span>], crs<span class="op">=</span>{<span class="st">'init'</span> :<span class="st">'epsg:4326'</span>})</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>sf_poly.crs, gpd_crime.crs <span class="co">#.crs -- geodataframe</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#spatial join</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>gpd_crime_city <span class="op">=</span> gpd.sjoin(gpd_crime,sf_poly,how<span class="op">=</span><span class="st">'inner'</span>,op <span class="op">=</span> <span class="st">'intersects'</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>gpd_crime_city.tail(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>gpd_crime_city.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#drop the useless data </span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>gpd_crime_city <span class="op">=</span> gpd_crime_city.drop([<span class="st">'bbox_north'</span>,<span class="st">'bbox_south'</span>,<span class="st">'bbox_east'</span>,<span class="st">'bbox_west'</span>,<span class="st">'index_right'</span>],axis <span class="op">=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="create-the-physical-environment-data" class="level2">
<h2 class="anchored" data-anchor-id="create-the-physical-environment-data">Create the Physical Environment Data</h2>
<section id="street" class="level3">
<h3 class="anchored" data-anchor-id="street">Street</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#get the street data of san francisco</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>sf_streets <span class="op">=</span> osmnx.graph_from_place(<span class="st">'San Francisco, California'</span>, network_type <span class="op">=</span> <span class="st">'drive'</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>nodes, edges <span class="op">=</span> osmnx.graph_to_gdfs(sf_streets)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>nodes.head(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>edges.head(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>edges.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># brief information of road dataset</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>sf_road <span class="op">=</span> edges.copy()</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sf_road[<span class="st">'highway'</span>].value_counts())</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Number of rows is '</span> <span class="op">+</span> <span class="bu">str</span>(sf_road.shape[<span class="dv">0</span>]))</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Number of columns is '</span> <span class="op">+</span> <span class="bu">str</span>(sf_road.shape[<span class="dv">1</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combining similar road types to reduce classification number</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>sf_road[<span class="st">'highway'</span>] <span class="op">=</span> sf_road[<span class="st">'highway'</span>].<span class="bu">str</span>.replace(<span class="st">'_link'</span>,<span class="st">''</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>sf_road[<span class="st">'highway'</span>] <span class="op">=</span> np.where(sf_road[<span class="st">'highway'</span>]<span class="op">==</span><span class="st">'trunk'</span>,<span class="st">'secondary'</span>,sf_road[<span class="st">'highway'</span>])</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>sf_road[<span class="st">'highway'</span>] <span class="op">=</span> np.where(sf_road[<span class="st">'highway'</span>]<span class="op">==</span><span class="st">'living_street'</span>,<span class="st">'residential'</span>,sf_road[<span class="st">'highway'</span>])</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sf_road[<span class="st">'highway'</span>].value_counts())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#based on road type to create sub-dataset</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>sf_highways <span class="op">=</span> sf_road[sf_road.highway <span class="op">==</span> <span class="st">'motorway'</span>]</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>sf_pry <span class="op">=</span> sf_road[sf_road.highway <span class="op">==</span> <span class="st">'primary'</span>]</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>sf_second <span class="op">=</span> sf_road[sf_road.highway <span class="op">==</span> <span class="st">'secondary'</span>]</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>sf_resid <span class="op">=</span> sf_road[sf_road.highway <span class="op">==</span> <span class="st">'residential'</span>]</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>sf_tertiary <span class="op">=</span> sf_road[sf_road.highway <span class="op">==</span> <span class="st">'tertiary'</span>]</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>sf_highways.crs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to geopandas files and set function to calcualte the min distance from point to road</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>gpd_crime_city_utm <span class="op">=</span> gpd_crime_city.to_crs({<span class="st">'init'</span>: <span class="st">'epsg:32610'</span>}).copy()   </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>highway_utm <span class="op">=</span> sf_highways.to_crs({<span class="st">'init'</span>: <span class="st">'epsg:32610'</span>}).copy()</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>primary_utm <span class="op">=</span> sf_pry.to_crs({<span class="st">'init'</span>: <span class="st">'epsg:32610'</span>}).copy()</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>secondary_utm <span class="op">=</span> sf_second.to_crs({<span class="st">'init'</span>: <span class="st">'epsg:32610'</span>}).copy()</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>tertiary_utm <span class="op">=</span> sf_tertiary.to_crs({<span class="st">'init'</span>: <span class="st">'epsg:32610'</span>}).copy()</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>residential_utm <span class="op">=</span> sf_resid.to_crs({<span class="st">'init'</span>: <span class="st">'epsg:32610'</span>}).copy()</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>sf_road_utm <span class="op">=</span> sf_road.to_crs({<span class="st">'init'</span>: <span class="st">'epsg:32610'</span>}).copy()</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> distance_to_roadway(gps,roadway):</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  dists <span class="op">=</span> []</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i <span class="kw">in</span> roadway.geometry:</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>    dists.append(i.distance(gps))</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> (np.<span class="bu">min</span>(dists))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>tqdm.pandas()</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>gpd_crime_city[<span class="st">'Closest_highway'</span>] <span class="op">=</span> gpd_crime_city_utm[<span class="st">'geometry'</span>].progress_apply(distance_to_roadway,roadway <span class="op">=</span> highway_utm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>tqdm.pandas()</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>gpd_crime_city[<span class="st">'Closest_primary'</span>] <span class="op">=</span> gpd_crime_city_utm[<span class="st">'geometry'</span>].progress_apply(distance_to_roadway,roadway <span class="op">=</span> primary_utm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>tqdm.pandas()</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>gpd_crime_city[<span class="st">'Closest_secondary'</span>] <span class="op">=</span> gpd_crime_city_utm[<span class="st">'geometry'</span>].progress_apply(distance_to_roadway,roadway <span class="op">=</span> secondary_utm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>tqdm.pandas()</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>gpd_crime_city[<span class="st">'Closest_tertiary'</span>] <span class="op">=</span> gpd_crime_city_utm[<span class="st">'geometry'</span>].progress_apply(distance_to_roadway,roadway <span class="op">=</span> tertiary_utm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:120,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1681676586562,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="48b5a544-8313-47a9-b2a6-b648a7a72a6b">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>gpd_crime_city.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="43">

  <div id="df-4269948c-6a2c-410c-803a-644d7192f053">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Incident Time</th>
<th data-quarto-table-cell-role="th">Incident Year</th>
<th data-quarto-table-cell-role="th">Incident Day of Week</th>
<th data-quarto-table-cell-role="th">Report Type Code</th>
<th data-quarto-table-cell-role="th">Incident Category</th>
<th data-quarto-table-cell-role="th">Incident Subcategory</th>
<th data-quarto-table-cell-role="th">Resolution</th>
<th data-quarto-table-cell-role="th">Intersection</th>
<th data-quarto-table-cell-role="th">Police District</th>
<th data-quarto-table-cell-role="th">Analysis Neighborhood</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lon</th>
<th data-quarto-table-cell-role="th">display_name</th>
<th data-quarto-table-cell-role="th">class</th>
<th data-quarto-table-cell-role="th">type</th>
<th data-quarto-table-cell-role="th">importance</th>
<th data-quarto-table-cell-role="th">Closest_highway</th>
<th data-quarto-table-cell-role="th">Closest_primary</th>
<th data-quarto-table-cell-role="th">Closest_secondary</th>
<th data-quarto-table-cell-role="th">Closest_tertiary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">9676</td>
<td>02:00</td>
<td>2020</td>
<td>Friday</td>
<td>II</td>
<td>Larceny Theft</td>
<td>Larceny Theft - Other</td>
<td>Open or Active</td>
<td>BASS CT \ WHITNEY YOUNG CIR</td>
<td>Bayview</td>
<td>Bayview Hunters Point</td>
<td>...</td>
<td>37.779026</td>
<td>-122.419906</td>
<td>San Francisco, CAL Fire Northern Region, Calif...</td>
<td>boundary</td>
<td>administrative</td>
<td>1.025131</td>
<td>1468.413426</td>
<td>534.950176</td>
<td>535.680061</td>
<td>506.558042</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13583</td>
<td>20:00</td>
<td>2020</td>
<td>Saturday</td>
<td>II</td>
<td>Larceny Theft</td>
<td>Larceny - From Vehicle</td>
<td>Open or Active</td>
<td>CLAY ST \ LARKIN ST</td>
<td>Central</td>
<td>Russian Hill</td>
<td>...</td>
<td>37.779026</td>
<td>-122.419906</td>
<td>San Francisco, CAL Fire Northern Region, Calif...</td>
<td>boundary</td>
<td>administrative</td>
<td>1.025131</td>
<td>2149.153684</td>
<td>390.024468</td>
<td>285.145981</td>
<td>97.658841</td>
</tr>
</tbody>
</table>


<p>2 rows × 36 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-4269948c-6a2c-410c-803a-644d7192f053')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-4269948c-6a2c-410c-803a-644d7192f053 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-4269948c-6a2c-410c-803a-644d7192f053');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># based on the closest distance from point to each type of roads to ensure the road type where the crime point locate</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_category(row):</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> row[<span class="st">'Closest_highway'</span>] <span class="op">&lt;</span> <span class="dv">10</span>:</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'highway'</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row[<span class="st">'Closest_primary'</span>] <span class="op">&lt;</span> <span class="dv">10</span>:</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'primary'</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row[<span class="st">'Closest_secondary'</span>] <span class="op">&lt;</span> <span class="dv">10</span>:</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'secondary'</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row[<span class="st">'Closest_tertiary'</span>] <span class="op">&lt;</span> <span class="dv">10</span>:</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'tertiary'</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'residential'</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>gpd_crime_city[<span class="st">'Crime_Location'</span>] <span class="op">=</span> gpd_crime_city.<span class="bu">apply</span>(get_category, axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:116,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1681677193540,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="a3ddf43c-7e7b-47a4-f452-e3b803d2b399">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>gpd_crime_city.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="51">

  <div id="df-a7e3e6c7-3dd1-47aa-bdcc-ba43dafec094">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Incident Time</th>
<th data-quarto-table-cell-role="th">Incident Year</th>
<th data-quarto-table-cell-role="th">Incident Day of Week</th>
<th data-quarto-table-cell-role="th">Report Type Code</th>
<th data-quarto-table-cell-role="th">Incident Category</th>
<th data-quarto-table-cell-role="th">Incident Subcategory</th>
<th data-quarto-table-cell-role="th">Resolution</th>
<th data-quarto-table-cell-role="th">Intersection</th>
<th data-quarto-table-cell-role="th">Police District</th>
<th data-quarto-table-cell-role="th">Analysis Neighborhood</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">lon</th>
<th data-quarto-table-cell-role="th">display_name</th>
<th data-quarto-table-cell-role="th">class</th>
<th data-quarto-table-cell-role="th">type</th>
<th data-quarto-table-cell-role="th">importance</th>
<th data-quarto-table-cell-role="th">Closest_highway</th>
<th data-quarto-table-cell-role="th">Closest_primary</th>
<th data-quarto-table-cell-role="th">Closest_secondary</th>
<th data-quarto-table-cell-role="th">Closest_tertiary</th>
<th data-quarto-table-cell-role="th">Crime_Location</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">9676</td>
<td>02:00</td>
<td>2020</td>
<td>Friday</td>
<td>II</td>
<td>Larceny Theft</td>
<td>Larceny Theft - Other</td>
<td>Open or Active</td>
<td>BASS CT \ WHITNEY YOUNG CIR</td>
<td>Bayview</td>
<td>Bayview Hunters Point</td>
<td>...</td>
<td>-122.419906</td>
<td>San Francisco, CAL Fire Northern Region, Calif...</td>
<td>boundary</td>
<td>administrative</td>
<td>1.025131</td>
<td>1468.413426</td>
<td>534.950176</td>
<td>535.680061</td>
<td>506.558042</td>
<td>residential</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13583</td>
<td>20:00</td>
<td>2020</td>
<td>Saturday</td>
<td>II</td>
<td>Larceny Theft</td>
<td>Larceny - From Vehicle</td>
<td>Open or Active</td>
<td>CLAY ST \ LARKIN ST</td>
<td>Central</td>
<td>Russian Hill</td>
<td>...</td>
<td>-122.419906</td>
<td>San Francisco, CAL Fire Northern Region, Calif...</td>
<td>boundary</td>
<td>administrative</td>
<td>1.025131</td>
<td>2149.153684</td>
<td>390.024468</td>
<td>285.145981</td>
<td>97.658841</td>
<td>residential</td>
</tr>
</tbody>
</table>


<p>2 rows × 37 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-a7e3e6c7-3dd1-47aa-bdcc-ba43dafec094')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-a7e3e6c7-3dd1-47aa-bdcc-ba43dafec094 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-a7e3e6c7-3dd1-47aa-bdcc-ba43dafec094');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:86,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1681677206942,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="e32e9433-435e-4c89-fccc-3c6a43413ab6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>gpd_crime_city.Crime_Location.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="52">
<pre><code>residential    10518
secondary       8670
tertiary        6382
primary         2520
highway          123
Name: Crime_Location, dtype: int64</code></pre>
</div>
</div>
</section>
<section id="zoning" class="level3">
<h3 class="anchored" data-anchor-id="zoning">Zoning</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">#https://drive.google.com/file/d/1sremJO16LufbhJdXzSiAViXUmtJCieCN/view?usp=share_link</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="bu">id</span> <span class="op">=</span> <span class="st">"1sremJO16LufbhJdXzSiAViXUmtJCieCN"</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="bu">file</span> <span class="op">=</span> drive.CreateFile({<span class="st">'id'</span>:<span class="bu">id</span>}) </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="bu">file</span>.GetContentFile(<span class="st">'SF_Zoning.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:262,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1681678587917,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="b2f3d4a8-398e-4a50-f468-4537a1cb5d56">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load zoning data</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>zoning_df <span class="op">=</span> pd.read_csv(<span class="st">'SF_Zoning.csv'</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>zoning_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="62">

  <div id="df-a79808e4-1944-4747-a9b7-1a9a7dd4a57b">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">the_geom</th>
<th data-quarto-table-cell-role="th">zoning_sim</th>
<th data-quarto-table-cell-role="th">districtname</th>
<th data-quarto-table-cell-role="th">url</th>
<th data-quarto-table-cell-role="th">gen</th>
<th data-quarto-table-cell-role="th">zoning</th>
<th data-quarto-table-cell-role="th">codesection</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>MULTIPOLYGON (((-122.41533105377357 37.7723137...</td>
<td>RED-MX</td>
<td>RESIDENTIAL ENCLAVE-MIXED</td>
<td>https://codelibrary.amlegal.com/codes/san_fran...</td>
<td>Mixed Use</td>
<td>RED-MX</td>
<td>847</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>MULTIPOLYGON (((-122.38902391194917 37.7381094...</td>
<td>NCD</td>
<td>BAYVIEW NEIGHBORHOOD COMMERCIAL DISTRICT</td>
<td>https://codelibrary.amlegal.com/codes/san_fran...</td>
<td>Mixed Use</td>
<td>NCD-BAYVIEW</td>
<td>737</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>MULTIPOLYGON (((-122.389357706792 37.738606785...</td>
<td>NCT-3</td>
<td>MODERATE SCALE NEIGHBORHOOD COMMERCIAL TRANSIT...</td>
<td>https://codelibrary.amlegal.com/codes/san_fran...</td>
<td>Mixed Use</td>
<td>NCT-3</td>
<td>752</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>MULTIPOLYGON (((-122.41533105377357 37.7723137...</td>
<td>RED</td>
<td>RESIDENTIAL ENCLAVE</td>
<td>https://codelibrary.amlegal.com/codes/san_fran...</td>
<td>Residential</td>
<td>RED</td>
<td>813</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>MULTIPOLYGON (((-122.38155774047206 37.7381229...</td>
<td>PDR-1-B</td>
<td>PDR LIGHT INDUSTRIAL BUFFER</td>
<td>https://codelibrary.amlegal.com/codes/san_fran...</td>
<td>Industrial</td>
<td>PDR-1-B</td>
<td>210.3</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-a79808e4-1944-4747-a9b7-1a9a7dd4a57b')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-a79808e4-1944-4747-a9b7-1a9a7dd4a57b button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-a79808e4-1944-4747-a9b7-1a9a7dd4a57b');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> shapely.wkt <span class="im">import</span> loads</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>zoning_df[<span class="st">'geometry'</span>] <span class="op">=</span> zoning_df[<span class="st">'the_geom'</span>].<span class="bu">apply</span>(loads)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a GeoPandas DataFrame from the Pandas DataFrame</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>zoning_gdf <span class="op">=</span> gpd.GeoDataFrame(zoning_df, crs<span class="op">=</span><span class="st">'EPSG:4326'</span>, geometry<span class="op">=</span><span class="st">'geometry'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>zoning_gdf.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">#drop irrelevant data</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>drop <span class="op">=</span> [<span class="st">'zoning_sim'</span>,<span class="st">'url'</span>,<span class="st">'zoning'</span>,<span class="st">'codesection'</span>]</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>zoning_new <span class="op">=</span> zoning_gdf.drop(columns<span class="op">=</span>drop)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>zoning_new.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">#brief visualization </span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">4</span>))</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>zoning_new.to_crs(epsg<span class="op">=</span><span class="dv">3857</span>).plot(ax <span class="op">=</span> ax,</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>                figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">12</span>),</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>                markersize<span class="op">=</span><span class="dv">40</span>,</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>               color<span class="op">=</span><span class="st">"black"</span>,</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>               edgecolor<span class="op">=</span><span class="st">"white"</span>,</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>               alpha<span class="op">=</span><span class="fl">0.8</span>,</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>               marker<span class="op">=</span><span class="st">"o"</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>            )<span class="op">;</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>ctx.add_basemap(ax, source<span class="op">=</span>ctx.providers.OpenStreetMap.Mapnik)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">#spatial join zoning data and crime data</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>gpd_crime_city_zone <span class="op">=</span> gpd.sjoin(gpd_crime_city, zoning_new, op<span class="op">=</span><span class="st">'within'</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>gpd_crime_city_zone.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="building" class="level3">
<h3 class="anchored" data-anchor-id="building">Building</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#https://drive.google.com/file/d/1-7NryT-DamfZnKO7mU9ZqZsISg5TInsC/view?usp=share_link</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="bu">id</span> <span class="op">=</span> <span class="st">"1-7NryT-DamfZnKO7mU9ZqZsISg5TInsC"</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="bu">file</span> <span class="op">=</span> drive.CreateFile({<span class="st">'id'</span>:<span class="bu">id</span>}) </span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="bu">file</span>.GetContentFile(<span class="st">'sf_building.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:4058,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682264265580,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="dbb2bc1d-4570-4104-b050-ef4656ee0e53">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co">#load building footprints data</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>building_df <span class="op">=</span> pd.read_csv(<span class="st">'sf_building.csv'</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>building_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="29">

  <div id="df-638ca247-595f-4a4f-8954-40adf9332777">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">sf16_bldgid</th>
<th data-quarto-table-cell-role="th">area_id</th>
<th data-quarto-table-cell-role="th">mblr</th>
<th data-quarto-table-cell-role="th">p2010_name</th>
<th data-quarto-table-cell-role="th">p2010_zminn88ft</th>
<th data-quarto-table-cell-role="th">p2010_zmaxn88ft</th>
<th data-quarto-table-cell-role="th">gnd_cells50cm</th>
<th data-quarto-table-cell-role="th">gnd_mincm</th>
<th data-quarto-table-cell-role="th">gnd_maxcm</th>
<th data-quarto-table-cell-role="th">gnd_rangecm</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">hgt_majoritycm</th>
<th data-quarto-table-cell-role="th">hgt_minoritycm</th>
<th data-quarto-table-cell-role="th">hgt_mediancm</th>
<th data-quarto-table-cell-role="th">gnd_min_m</th>
<th data-quarto-table-cell-role="th">median_1st_m</th>
<th data-quarto-table-cell-role="th">hgt_median_m</th>
<th data-quarto-table-cell-role="th">gnd1st_delta</th>
<th data-quarto-table-cell-role="th">peak_1st_m</th>
<th data-quarto-table-cell-role="th">globalid</th>
<th data-quarto-table-cell-role="th">shape</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>201006.000000</td>
<td>1</td>
<td>SF4570025</td>
<td>SanfranF_4606.flt</td>
<td>16.3249</td>
<td>66.2671</td>
<td>178250</td>
<td>507</td>
<td>704</td>
<td>197</td>
<td>...</td>
<td>813</td>
<td>349</td>
<td>850</td>
<td>5.07</td>
<td>14.16</td>
<td>8.50</td>
<td>9.09</td>
<td>23.85</td>
<td>{CF7EF595-68E6-4950-B361-CC82D77383A0}</td>
<td>MULTIPOLYGON (((-122.37950387699999 37.7397994...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>201006.000000</td>
<td>2</td>
<td>SM005050270</td>
<td>SanfranI_09417.flt</td>
<td>81.7802</td>
<td>214.1874</td>
<td>144111</td>
<td>2515</td>
<td>3419</td>
<td>904</td>
<td>...</td>
<td>737</td>
<td>11</td>
<td>735</td>
<td>25.15</td>
<td>39.25</td>
<td>7.35</td>
<td>14.10</td>
<td>66.94</td>
<td>{806F8EDB-7B25-4054-898E-6F2CF65D072E}</td>
<td>MULTIPOLYGON (((-122.41894297800002 37.7076482...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>201006.000000</td>
<td>3</td>
<td>SF3794028</td>
<td>Sanfran_Orig_1330.flt</td>
<td>12.5027</td>
<td>102.5737</td>
<td>115295</td>
<td>164</td>
<td>507</td>
<td>343</td>
<td>...</td>
<td>734</td>
<td>-86</td>
<td>1157</td>
<td>1.64</td>
<td>15.29</td>
<td>11.57</td>
<td>13.65</td>
<td>59.18</td>
<td>{F0F234CF-3F0B-439D-B59A-8899C2135F23}</td>
<td>MULTIPOLYGON (((-122.38881976200003 37.7792352...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>201006.003228</td>
<td>32278</td>
<td>SM004154340</td>
<td>SanfranP_3364.flt</td>
<td>342.5260</td>
<td>381.3803</td>
<td>708</td>
<td>10454</td>
<td>10532</td>
<td>78</td>
<td>...</td>
<td>521</td>
<td>140</td>
<td>456</td>
<td>104.54</td>
<td>109.39</td>
<td>4.56</td>
<td>4.85</td>
<td>111.79</td>
<td>{C321EB73-7E6E-49B5-822B-3E7DD3A7F0AD}</td>
<td>MULTIPOLYGON (((-122.45552821000001 37.7074943...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>201006.000000</td>
<td>4</td>
<td>SF7295021</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>107634</td>
<td>4346</td>
<td>5185</td>
<td>839</td>
<td>...</td>
<td>1078</td>
<td>16</td>
<td>1153</td>
<td>43.46</td>
<td>61.58</td>
<td>11.53</td>
<td>18.12</td>
<td>69.72</td>
<td>{C52C089C-B0A6-4716-8358-C568A65861DC}</td>
<td>MULTIPOLYGON (((-122.47734992300002 37.7289024...</td>
</tr>
</tbody>
</table>


<p>5 rows × 43 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-638ca247-595f-4a4f-8954-40adf9332777')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-638ca247-595f-4a4f-8954-40adf9332777 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-638ca247-595f-4a4f-8954-40adf9332777');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">##keep the geometry and height data</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>building_df <span class="op">=</span> building_df[[<span class="st">'peak_1st_m'</span>,<span class="st">'shape'</span>]]</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>building_df.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>building_df[<span class="st">'geometry'</span>] <span class="op">=</span> building_df[<span class="st">'shape'</span>].<span class="bu">apply</span>(loads)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a GeoPandas DataFrame from the Pandas DataFrame</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>building_gdf <span class="op">=</span> gpd.GeoDataFrame(building_df, crs<span class="op">=</span><span class="st">'EPSG:4326'</span>, geometry<span class="op">=</span><span class="st">'geometry'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>building_gdf.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the area of each building</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>building_gdf[<span class="st">'area'</span>] <span class="op">=</span> building_gdf[<span class="st">'geometry'</span>].area</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>building_gdf.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># turan the form of data from polygon to point for find nearest point</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>point_gdf <span class="op">=</span> building_gdf.copy()</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>point_gdf[<span class="st">"geometry"</span>] <span class="op">=</span> building_gdf.centroid</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>point_gdf.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>gpd_crime_city_zone <span class="op">=</span> gpd_crime_city_zone.rename(columns<span class="op">=</span>{<span class="st">'index_left'</span>: <span class="st">'left'</span>})</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>gpd_crime_city_zone <span class="op">=</span> gpd_crime_city_zone.rename(columns<span class="op">=</span>{<span class="st">'index_right'</span>: <span class="st">'right'</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>gpd_crime_city_zone.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:17913,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682276381353,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="ba02ebb2-fb4a-4253-84b3-e517ad200d46">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> google.colab <span class="im">import</span> drive</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>drive.mount(<span class="st">'/content/drive'</span>)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="co">#save_path = '/content/drive/MyDrive/Colab Notebooks/data/gpd_crime_city_zone.csv'</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="co">#df.to_csv(save_path, index=False)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Mounted at /content/drive</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co">#https://drive.google.com/file/d/1WkxWvKEsSpq50x-BEasGqmsgu6pi91_m/view?usp=share_link</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="bu">id</span> <span class="op">=</span> <span class="st">"1WkxWvKEsSpq50x-BEasGqmsgu6pi91_m"</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="bu">file</span> <span class="op">=</span> drive.CreateFile({<span class="st">'id'</span>:<span class="bu">id</span>}) </span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="bu">file</span>.GetContentFile(<span class="st">'gpd_crime_city_zone.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:7227,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682263974992,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="7d5a0b55-fa2c-42c2-b8da-fab4656489c2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>gpd_crime_city_zone <span class="op">=</span> pd.read_csv(<span class="st">'gpd_crime_city_zone.csv'</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>gpd_crime_city_zone.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="24">

  <div id="df-d67f4648-9245-47c8-bb32-145f1b77dd79">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Incident Time</th>
<th data-quarto-table-cell-role="th">Incident Year</th>
<th data-quarto-table-cell-role="th">Incident Day of Week</th>
<th data-quarto-table-cell-role="th">Report Type Code</th>
<th data-quarto-table-cell-role="th">Incident Category</th>
<th data-quarto-table-cell-role="th">Incident Subcategory</th>
<th data-quarto-table-cell-role="th">Resolution</th>
<th data-quarto-table-cell-role="th">Intersection</th>
<th data-quarto-table-cell-role="th">Police District</th>
<th data-quarto-table-cell-role="th">Analysis Neighborhood</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Closest_primary</th>
<th data-quarto-table-cell-role="th">Closest_secondary</th>
<th data-quarto-table-cell-role="th">Closest_tertiary</th>
<th data-quarto-table-cell-role="th">Crime_Location</th>
<th data-quarto-table-cell-role="th">right</th>
<th data-quarto-table-cell-role="th">the_geom</th>
<th data-quarto-table-cell-role="th">districtname</th>
<th data-quarto-table-cell-role="th">gen</th>
<th data-quarto-table-cell-role="th">buffer_5m</th>
<th data-quarto-table-cell-role="th">buffer</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>02:00</td>
<td>2020</td>
<td>Friday</td>
<td>II</td>
<td>Larceny Theft</td>
<td>Larceny Theft - Other</td>
<td>Open or Active</td>
<td>BASS CT \ WHITNEY YOUNG CIR</td>
<td>Bayview</td>
<td>Bayview Hunters Point</td>
<td>...</td>
<td>534.950176</td>
<td>535.680061</td>
<td>506.558042</td>
<td>residential</td>
<td>815</td>
<td>MULTIPOLYGON (((-122.38222192626027 37.7365910...</td>
<td>RESIDENTIAL- HOUSE, TWO FAMILY</td>
<td>Residential</td>
<td>POLYGON ((-117.38469170531177 37.7337597458953...</td>
<td>POLYGON ((-117.38469170531177 37.7337597458953...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>13:59</td>
<td>2020</td>
<td>Sunday</td>
<td>VI</td>
<td>Larceny Theft</td>
<td>Theft From Vehicle</td>
<td>Open or Active</td>
<td>WHITNEY YOUNG CIR \ CASHMERE ST \ DEDMAN CT</td>
<td>Bayview</td>
<td>Bayview Hunters Point</td>
<td>...</td>
<td>364.965970</td>
<td>433.206386</td>
<td>203.201740</td>
<td>residential</td>
<td>815</td>
<td>MULTIPOLYGON (((-122.38222192626027 37.7365910...</td>
<td>RESIDENTIAL- HOUSE, TWO FAMILY</td>
<td>Residential</td>
<td>POLYGON ((-117.38571301129124 37.7366011278019...</td>
<td>POLYGON ((-117.38571301129124 37.7366011278019...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>16:28</td>
<td>2020</td>
<td>Friday</td>
<td>II</td>
<td>Larceny Theft</td>
<td>Larceny Theft - Other</td>
<td>Open or Active</td>
<td>LA SALLE AVE \ OSCEOLA LN</td>
<td>Bayview</td>
<td>Bayview Hunters Point</td>
<td>...</td>
<td>833.743266</td>
<td>461.886008</td>
<td>835.429639</td>
<td>residential</td>
<td>815</td>
<td>MULTIPOLYGON (((-122.38222192626027 37.7365910...</td>
<td>RESIDENTIAL- HOUSE, TWO FAMILY</td>
<td>Residential</td>
<td>POLYGON ((-117.3819485575142 37.73152913469796...</td>
<td>POLYGON ((-117.3819485575142 37.73152913469796...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>18:00</td>
<td>2020</td>
<td>Tuesday</td>
<td>II</td>
<td>Larceny Theft</td>
<td>Larceny - Auto Parts</td>
<td>Open or Active</td>
<td>INGALLS ST \ HARBOR RD</td>
<td>Bayview</td>
<td>Bayview Hunters Point</td>
<td>...</td>
<td>951.461748</td>
<td>255.279620</td>
<td>825.220932</td>
<td>residential</td>
<td>815</td>
<td>MULTIPOLYGON (((-122.38222192626027 37.7365910...</td>
<td>RESIDENTIAL- HOUSE, TWO FAMILY</td>
<td>Residential</td>
<td>POLYGON ((-117.3799317268322 37.73338073279184...</td>
<td>POLYGON ((-117.3799317268322 37.73338073279184...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>21:00</td>
<td>2020</td>
<td>Sunday</td>
<td>VI</td>
<td>Larceny Theft</td>
<td>Theft From Vehicle</td>
<td>Open or Active</td>
<td>CASHMERE ST \ HUDSON AVE</td>
<td>Bayview</td>
<td>Bayview Hunters Point</td>
<td>...</td>
<td>582.547890</td>
<td>387.780374</td>
<td>420.026310</td>
<td>residential</td>
<td>815</td>
<td>MULTIPOLYGON (((-122.38222192626027 37.7365910...</td>
<td>RESIDENTIAL- HOUSE, TWO FAMILY</td>
<td>Residential</td>
<td>POLYGON ((-117.38342544658872 37.7358032525956...</td>
<td>POLYGON ((-117.38342544658872 37.7358032525956...</td>
</tr>
</tbody>
</table>


<p>5 rows × 43 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-d67f4648-9245-47c8-bb32-145f1b77dd79')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-d67f4648-9245-47c8-bb32-145f1b77dd79 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-d67f4648-9245-47c8-bb32-145f1b77dd79');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>gpd_crime_city_zone <span class="op">=</span> gpd.GeoDataFrame(gpd_crime_city_zone, geometry<span class="op">=</span>gpd.points_from_xy(gpd_crime_city_zone.Longitude, gpd_crime_city_zone.Latitude), crs<span class="op">=</span>{<span class="st">'init'</span> :<span class="st">'epsg:4326'</span>})</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>gpd_crime_city_zone.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.spatial <span class="im">import</span> cKDTree</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>pd_crime_city_zone <span class="op">=</span> np.array(<span class="bu">list</span>(gpd_crime_city_zone.geometry.<span class="bu">apply</span>(<span class="kw">lambda</span> pt: (pt.x, pt.y))))</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>point_df <span class="op">=</span> np.array(<span class="bu">list</span>(point_gdf.geometry.<span class="bu">apply</span>(<span class="kw">lambda</span> pt: (pt.x, pt.y))))</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Build cKDTree from crime points</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>tree <span class="op">=</span> cKDTree(point_df)</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Query tree for nearest crime to each Boston point</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>dist, idx <span class="op">=</span> tree.query(pd_crime_city_zone, k<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Add nearest crime column to boston GeoDataFrame</span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>gpd_crime_city_zone[<span class="st">'builidng_nn1'</span>] <span class="op">=</span> point_gdf.loc[idx, <span class="st">'peak_1st_m'</span>].values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>drop <span class="op">=</span> [<span class="st">'buffer_5m'</span>,<span class="st">'buffer'</span>,<span class="st">'right'</span>]</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>gpd_crime_city_zone <span class="op">=</span> gpd_crime_city_zone.drop(columns<span class="op">=</span>drop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>val_dict <span class="op">=</span> {<span class="st">'highway'</span>: <span class="dv">24</span>, <span class="st">'primary'</span>: <span class="dv">20</span>, <span class="st">'secondary'</span>: <span class="dv">12</span>, <span class="st">'tertiary'</span>: <span class="dv">8</span>, <span class="st">'residential'</span>: <span class="dv">6</span>}</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>gpd_crime_city_zone[<span class="st">'road_width'</span>] <span class="op">=</span> gpd_crime_city_zone[<span class="st">'Crime_Location'</span>].<span class="bu">map</span>(val_dict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>gpd_crime_city_zone[<span class="st">'rate_BS'</span>] <span class="op">=</span> gpd_crime_city_zone[<span class="st">'builidng_nn1'</span>]<span class="op">/</span>gpd_crime_city_zone[<span class="st">'road_width'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="census-tract" class="level3">
<h3 class="anchored" data-anchor-id="census-tract">Census tract</h3>
<section id="load-basic-census-tract-boundary" class="level4">
<h4 class="anchored" data-anchor-id="load-basic-census-tract-boundary">load basic census tract boundary</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co">#https://drive.google.com/file/d/1DbA90nYecBQnwRkcqUAAP8vT7OQP9MWz/view?usp=share_link</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="bu">id</span> <span class="op">=</span> <span class="st">"1DbA90nYecBQnwRkcqUAAP8vT7OQP9MWz"</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="bu">file</span> <span class="op">=</span> drive.CreateFile({<span class="st">'id'</span>:<span class="bu">id</span>}) </span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="bu">file</span>.GetContentFile(<span class="st">'sf_centra.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682264921945,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="0388d99a-a302-4975-a3bb-e8eda42f0b35">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>ct_df <span class="op">=</span> pd.read_csv(<span class="st">'sf_centra.csv'</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>ct_df.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 176 entries, 0 to 175
Data columns (total 47 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   the_geom    176 non-null    object 
 1   OBJECTID    176 non-null    int64  
 2   FIPSSTCO    176 non-null    int64  
 3   TRT2000     176 non-null    int64  
 4   STFID       176 non-null    int64  
 5   TRACTID     176 non-null    float64
 6   STATE       176 non-null    int64  
 7   COUNTY      176 non-null    int64  
 8   TRACT       176 non-null    int64  
 9   POP2000     176 non-null    int64  
 10  WHITE       176 non-null    int64  
 11  BLACK       176 non-null    int64  
 12  AMERI_ES    176 non-null    int64  
 13  ASIAN       176 non-null    int64  
 14  HAWN_PI     176 non-null    int64  
 15  OTHER       176 non-null    int64  
 16  MULT_RACE   176 non-null    int64  
 17  HISPANIC    176 non-null    int64  
 18  MALES       176 non-null    int64  
 19  FEMALES     176 non-null    int64  
 20  AGE_UNDER5  176 non-null    int64  
 21  AGE_5_17    176 non-null    int64  
 22  AGE_18_21   176 non-null    int64  
 23  AGE_22_29   176 non-null    int64  
 24  AGE_30_39   176 non-null    int64  
 25  AGE_40_49   176 non-null    int64  
 26  AGE_50_64   176 non-null    int64  
 27  AGE_65_UP   176 non-null    int64  
 28  MED_AGE     176 non-null    float64
 29  MED_AGE_M   176 non-null    float64
 30  MED_AGE_F   176 non-null    float64
 31  HOUSEHOLDS  176 non-null    int64  
 32  AVE_HH_SZ   176 non-null    float64
 33  HSEHLD_1_M  176 non-null    int64  
 34  HSEHLD_1_F  176 non-null    int64  
 35  MARHH_CHD   176 non-null    int64  
 36  MARHH_NO_C  176 non-null    int64  
 37  MHH_CHILD   176 non-null    int64  
 38  FHH_CHILD   176 non-null    int64  
 39  FAMILIES    176 non-null    int64  
 40  AVE_FAM_SZ  176 non-null    float64
 41  HSE_UNITS   176 non-null    int64  
 42  URBAN       176 non-null    int64  
 43  RURAL       176 non-null    int64  
 44  VACANT      176 non-null    int64  
 45  OWNER_OCC   176 non-null    int64  
 46  RENTER_OCC  176 non-null    int64  
dtypes: float64(6), int64(40), object(1)
memory usage: 64.8+ KB</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>ct_df[<span class="st">'TRACTID'</span>] <span class="op">=</span> ct_df[<span class="st">'TRACTID'</span>].astype(<span class="st">'object'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="load-social-economic-data-based-on-the-census-tract" class="level4">
<h4 class="anchored" data-anchor-id="load-social-economic-data-based-on-the-census-tract">load social-economic data based on the census tract</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> censusdata</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> census <span class="im">import</span> Census</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> us <span class="im">import</span> states</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the Census API key</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>censusdata.censuskey <span class="op">=</span> <span class="st">"93db71b5bb2f994846b61d1cb53de6b204ed41b8"</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> Census(<span class="st">"93db71b5bb2f994846b61d1cb53de6b204ed41b8"</span>)</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>year <span class="op">=</span> <span class="dv">2020</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>state_fips <span class="op">=</span> <span class="st">'06'</span>  <span class="co"># California</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>county_fips <span class="op">=</span> <span class="st">'075'</span>  <span class="co"># San Francisco County</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   B07010_004 -- Estimate!!Total:!!With income:!!$1 to $9,999 or loss -- poverty indicator</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a><span class="co"># B06009_002 -- Estimate!!Total:!!Less than high school graduate</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a><span class="co"># B09010_002 -- Estimate!!Total:!!Living in household with Supplemental Security Income (SSI), cash public assistance income, or Food Stamps/SNAP in the past 12 months:</span></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a><span class="co"># B27011_008 -- Estimate!!Total:!!In labor force:!!Unemployed:</span></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a><span class="co"># B11013_002 -- Estimate!!Total:!!Married-couple subfamily</span></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a><span class="co"># B11013_005 -- Estimate!!Total:!!Mother-child subfamily</span></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a><span class="co"># B11013_006 -- Estimate!!Total:!!Father-child subfamily</span></span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>va_census <span class="op">=</span> c.acs5.state_county_tract(fields <span class="op">=</span> (<span class="st">'NAME'</span>,<span class="st">'B07010_004E'</span>,<span class="st">'B06009_002E'</span>, <span class="st">'B09010_002E'</span>, <span class="st">'B27011_008E'</span>,<span class="st">'B11014_005E'</span>,<span class="st">'B11014_006E'</span>,<span class="st">'B11014_009E'</span>),</span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>                                      state_fips <span class="op">=</span> <span class="st">'06'</span>,</span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>                                      county_fips <span class="op">=</span> <span class="st">'075'</span>,</span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>                                      tract <span class="op">=</span> <span class="st">"*"</span>,</span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>                                      year <span class="op">=</span> <span class="dv">2020</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>sfp_df <span class="op">=</span> pd.DataFrame(va_census)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>sfp_df.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>sfp_df[<span class="st">'tract'</span>] <span class="op">=</span> sfp_df[<span class="st">'NAME'</span>].<span class="bu">str</span>.extract(<span class="vs">r'Census Tract (\d+\.\d+)'</span>, expand<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>sfp_df.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>sfp_df <span class="op">=</span> sfp_df.rename(columns<span class="op">=</span>{<span class="st">'B07010_004E'</span>: <span class="st">'low_income'</span>, <span class="st">'B06009_002E'</span>:<span class="st">'low_education'</span>,<span class="st">'B09010_002E'</span>:<span class="st">'fd_secure'</span>,<span class="st">'B27011_008E'</span>:<span class="st">'unemploy'</span>,<span class="st">'B11014_005E'</span>:<span class="st">'couple_fa'</span>,</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'B11014_006E'</span>:<span class="st">'ma-child'</span>,<span class="st">'B11014_009E'</span>:<span class="st">'fa-child'</span>})</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>sfp_df.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>sfp_df <span class="op">=</span> sfp_df.rename(columns<span class="op">=</span>{<span class="st">'tract'</span>: <span class="st">'TRACTID'</span>})</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>sfp_df.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>socieco_df <span class="op">=</span> pd.merge(ct_df, sfp_df, on<span class="op">=</span><span class="st">'TRACTID'</span>,how<span class="op">=</span><span class="st">'left'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>ct_df[<span class="st">'geometry'</span>] <span class="op">=</span> ct_df[<span class="st">'the_geom'</span>].<span class="bu">apply</span>(loads)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a GeoPandas DataFrame from the Pandas DataFrame</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>ct_gdf <span class="op">=</span> gpd.GeoDataFrame(ct_df, crs<span class="op">=</span><span class="st">'EPSG:4326'</span>, geometry<span class="op">=</span><span class="st">'geometry'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
</section>
<section id="data-analysis-and-visualization" class="level1">
<h1>Data Analysis and Visualization</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the data that crime with place's social-economic type</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>gpd_crime_fnl <span class="op">=</span> gpd.sjoin(gpd_crime_city_zone, ct_gdf, op<span class="op">=</span><span class="st">'within'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.max_columns'</span>, <span class="va">None</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:316,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682266458960,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="fc9be696-bc43-4ef0-c82f-9d51fe1ecf92">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>gpd_crime_fnl.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="73">

  <div id="df-f331d5a5-7ee8-4548-8db1-e3983e266230">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Incident Time</th>
<th data-quarto-table-cell-role="th">Incident Year</th>
<th data-quarto-table-cell-role="th">Incident Day of Week</th>
<th data-quarto-table-cell-role="th">Report Type Code</th>
<th data-quarto-table-cell-role="th">Incident Category</th>
<th data-quarto-table-cell-role="th">Incident Subcategory</th>
<th data-quarto-table-cell-role="th">Resolution</th>
<th data-quarto-table-cell-role="th">Intersection</th>
<th data-quarto-table-cell-role="th">Police District</th>
<th data-quarto-table-cell-role="th">Analysis Neighborhood</th>
<th data-quarto-table-cell-role="th">Supervisor District 2012</th>
<th data-quarto-table-cell-role="th">Latitude</th>
<th data-quarto-table-cell-role="th">Longitude</th>
<th data-quarto-table-cell-role="th">Point</th>
<th data-quarto-table-cell-role="th">Neighborhoods</th>
<th data-quarto-table-cell-role="th">ESNCAG - Boundary File</th>
<th data-quarto-table-cell-role="th">geometry</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
<th data-quarto-table-cell-role="th">Result</th>
<th data-quarto-table-cell-role="th">place_id</th>
<th data-quarto-table-cell-role="th">osm_type</th>
<th data-quarto-table-cell-role="th">osm_id</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lon</th>
<th data-quarto-table-cell-role="th">display_name</th>
<th data-quarto-table-cell-role="th">class</th>
<th data-quarto-table-cell-role="th">type</th>
<th data-quarto-table-cell-role="th">importance</th>
<th data-quarto-table-cell-role="th">Closest_highway</th>
<th data-quarto-table-cell-role="th">Closest_primary</th>
<th data-quarto-table-cell-role="th">Closest_secondary</th>
<th data-quarto-table-cell-role="th">Closest_tertiary</th>
<th data-quarto-table-cell-role="th">Crime_Location</th>
<th data-quarto-table-cell-role="th">the_geom_left</th>
<th data-quarto-table-cell-role="th">districtname</th>
<th data-quarto-table-cell-role="th">gen</th>
<th data-quarto-table-cell-role="th">builidng_nn1</th>
<th data-quarto-table-cell-role="th">road_width</th>
<th data-quarto-table-cell-role="th">rate_BS</th>
<th data-quarto-table-cell-role="th">index_right</th>
<th data-quarto-table-cell-role="th">the_geom_right</th>
<th data-quarto-table-cell-role="th">OBJECTID</th>
<th data-quarto-table-cell-role="th">FIPSSTCO</th>
<th data-quarto-table-cell-role="th">TRT2000</th>
<th data-quarto-table-cell-role="th">STFID</th>
<th data-quarto-table-cell-role="th">TRACTID</th>
<th data-quarto-table-cell-role="th">STATE</th>
<th data-quarto-table-cell-role="th">COUNTY</th>
<th data-quarto-table-cell-role="th">TRACT</th>
<th data-quarto-table-cell-role="th">POP2000</th>
<th data-quarto-table-cell-role="th">WHITE</th>
<th data-quarto-table-cell-role="th">BLACK</th>
<th data-quarto-table-cell-role="th">AMERI_ES</th>
<th data-quarto-table-cell-role="th">ASIAN</th>
<th data-quarto-table-cell-role="th">HAWN_PI</th>
<th data-quarto-table-cell-role="th">OTHER</th>
<th data-quarto-table-cell-role="th">MULT_RACE</th>
<th data-quarto-table-cell-role="th">HISPANIC</th>
<th data-quarto-table-cell-role="th">MALES</th>
<th data-quarto-table-cell-role="th">FEMALES</th>
<th data-quarto-table-cell-role="th">AGE_UNDER5</th>
<th data-quarto-table-cell-role="th">AGE_5_17</th>
<th data-quarto-table-cell-role="th">AGE_18_21</th>
<th data-quarto-table-cell-role="th">AGE_22_29</th>
<th data-quarto-table-cell-role="th">AGE_30_39</th>
<th data-quarto-table-cell-role="th">AGE_40_49</th>
<th data-quarto-table-cell-role="th">AGE_50_64</th>
<th data-quarto-table-cell-role="th">AGE_65_UP</th>
<th data-quarto-table-cell-role="th">MED_AGE</th>
<th data-quarto-table-cell-role="th">MED_AGE_M</th>
<th data-quarto-table-cell-role="th">MED_AGE_F</th>
<th data-quarto-table-cell-role="th">HOUSEHOLDS</th>
<th data-quarto-table-cell-role="th">AVE_HH_SZ</th>
<th data-quarto-table-cell-role="th">HSEHLD_1_M</th>
<th data-quarto-table-cell-role="th">HSEHLD_1_F</th>
<th data-quarto-table-cell-role="th">MARHH_CHD</th>
<th data-quarto-table-cell-role="th">MARHH_NO_C</th>
<th data-quarto-table-cell-role="th">MHH_CHILD</th>
<th data-quarto-table-cell-role="th">FHH_CHILD</th>
<th data-quarto-table-cell-role="th">FAMILIES</th>
<th data-quarto-table-cell-role="th">AVE_FAM_SZ</th>
<th data-quarto-table-cell-role="th">HSE_UNITS</th>
<th data-quarto-table-cell-role="th">URBAN</th>
<th data-quarto-table-cell-role="th">RURAL</th>
<th data-quarto-table-cell-role="th">VACANT</th>
<th data-quarto-table-cell-role="th">OWNER_OCC</th>
<th data-quarto-table-cell-role="th">RENTER_OCC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>02:00</td>
<td>2020</td>
<td>Friday</td>
<td>II</td>
<td>Larceny Theft</td>
<td>Larceny Theft - Other</td>
<td>Open or Active</td>
<td>BASS CT \ WHITNEY YOUNG CIR</td>
<td>Bayview</td>
<td>Bayview Hunters Point</td>
<td>10.0</td>
<td>37.733760</td>
<td>-122.384692</td>
<td>POINT (-122.38469170531177 37.73375974589532)</td>
<td>86.0</td>
<td>NaN</td>
<td>POINT (-122.38469 37.73376)</td>
<td>2020</td>
<td>4</td>
<td>10</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>297983890</td>
<td>relation</td>
<td>111968</td>
<td>37.779026</td>
<td>-122.419906</td>
<td>San Francisco, CAL Fire Northern Region, Calif...</td>
<td>boundary</td>
<td>administrative</td>
<td>1.025131</td>
<td>1468.413426</td>
<td>534.950176</td>
<td>535.680061</td>
<td>506.558042</td>
<td>residential</td>
<td>MULTIPOLYGON (((-122.38222192626027 37.7365910...</td>
<td>RESIDENTIAL- HOUSE, TWO FAMILY</td>
<td>Residential</td>
<td>18.58</td>
<td>6</td>
<td>3.096667</td>
<td>42</td>
<td>MULTIPOLYGON (((-122.38155725680222 37.7381228...</td>
<td>239</td>
<td>6075</td>
<td>23102</td>
<td>6075023102</td>
<td>231.02</td>
<td>6</td>
<td>75</td>
<td>23102</td>
<td>3600</td>
<td>230</td>
<td>2625</td>
<td>7</td>
<td>421</td>
<td>29</td>
<td>148</td>
<td>140</td>
<td>321</td>
<td>1637</td>
<td>1963</td>
<td>262</td>
<td>957</td>
<td>180</td>
<td>340</td>
<td>559</td>
<td>504</td>
<td>482</td>
<td>316</td>
<td>31.0</td>
<td>26.7</td>
<td>34.5</td>
<td>1259</td>
<td>2.86</td>
<td>111</td>
<td>203</td>
<td>171</td>
<td>117</td>
<td>24</td>
<td>307</td>
<td>876</td>
<td>3.4</td>
<td>1289</td>
<td>0</td>
<td>0</td>
<td>30</td>
<td>456</td>
<td>803</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>13:59</td>
<td>2020</td>
<td>Sunday</td>
<td>VI</td>
<td>Larceny Theft</td>
<td>Theft From Vehicle</td>
<td>Open or Active</td>
<td>WHITNEY YOUNG CIR \ CASHMERE ST \ DEDMAN CT</td>
<td>Bayview</td>
<td>Bayview Hunters Point</td>
<td>10.0</td>
<td>37.736601</td>
<td>-122.385713</td>
<td>POINT (-122.38571301129124 37.7366011278019)</td>
<td>86.0</td>
<td>NaN</td>
<td>POINT (-122.38571 37.73660)</td>
<td>2020</td>
<td>2</td>
<td>9</td>
<td>13</td>
<td>59</td>
<td>0</td>
<td>297983890</td>
<td>relation</td>
<td>111968</td>
<td>37.779026</td>
<td>-122.419906</td>
<td>San Francisco, CAL Fire Northern Region, Calif...</td>
<td>boundary</td>
<td>administrative</td>
<td>1.025131</td>
<td>1194.113022</td>
<td>364.965970</td>
<td>433.206386</td>
<td>203.201740</td>
<td>residential</td>
<td>MULTIPOLYGON (((-122.38222192626027 37.7365910...</td>
<td>RESIDENTIAL- HOUSE, TWO FAMILY</td>
<td>Residential</td>
<td>18.58</td>
<td>6</td>
<td>3.096667</td>
<td>42</td>
<td>MULTIPOLYGON (((-122.38155725680222 37.7381228...</td>
<td>239</td>
<td>6075</td>
<td>23102</td>
<td>6075023102</td>
<td>231.02</td>
<td>6</td>
<td>75</td>
<td>23102</td>
<td>3600</td>
<td>230</td>
<td>2625</td>
<td>7</td>
<td>421</td>
<td>29</td>
<td>148</td>
<td>140</td>
<td>321</td>
<td>1637</td>
<td>1963</td>
<td>262</td>
<td>957</td>
<td>180</td>
<td>340</td>
<td>559</td>
<td>504</td>
<td>482</td>
<td>316</td>
<td>31.0</td>
<td>26.7</td>
<td>34.5</td>
<td>1259</td>
<td>2.86</td>
<td>111</td>
<td>203</td>
<td>171</td>
<td>117</td>
<td>24</td>
<td>307</td>
<td>876</td>
<td>3.4</td>
<td>1289</td>
<td>0</td>
<td>0</td>
<td>30</td>
<td>456</td>
<td>803</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-f331d5a5-7ee8-4548-8db1-e3983e266230')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-f331d5a5-7ee8-4548-8db1-e3983e266230 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-f331d5a5-7ee8-4548-8db1-e3983e266230');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>gpd_crime_fnl[<span class="st">'gen'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_category(row):</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> row[<span class="st">'gen'</span>] <span class="op">==</span> <span class="st">'Residential'</span>:</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row[<span class="st">'gen'</span>] <span class="op">==</span> <span class="st">'Mixed Use'</span>:</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">2</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row[<span class="st">'gen'</span>] <span class="op">==</span> <span class="st">'Commercial'</span>:</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">3</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row[<span class="st">'gen'</span>] <span class="op">==</span> <span class="st">'Public'</span>:</span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">4</span></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">5</span></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>gpd_crime_fnl[<span class="st">'ztype'</span>] <span class="op">=</span> gpd_crime_fnl.<span class="bu">apply</span>(get_category, axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>gpd_crime_fnl[<span class="st">'Crime_Location'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_category(row):</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> row[<span class="st">'Crime_Location'</span>] <span class="op">==</span> <span class="st">'residential'</span>:</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row[<span class="st">'Crime_Location'</span>] <span class="op">==</span> <span class="st">'secondary'</span>:</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">2</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row[<span class="st">'Crime_Location'</span>] <span class="op">==</span> <span class="st">'tertiary'</span>:</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">3</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row[<span class="st">'Crime_Location'</span>] <span class="op">==</span> <span class="st">'primary'</span>:</span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">4</span></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">5</span></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>gpd_crime_fnl[<span class="st">'rtype'</span>] <span class="op">=</span> gpd_crime_fnl.<span class="bu">apply</span>(get_category, axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Numerical Features</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>numerical <span class="op">=</span> [<span class="st">'Result'</span>,<span class="st">'Neighborhoods'</span>, <span class="st">'Supervisor District 2012'</span>, <span class="st">'month'</span>, <span class="st">'day'</span>, <span class="st">'hour'</span>, <span class="st">'minute'</span>, <span class="st">'Closest_highway'</span>, <span class="st">'Closest_primary'</span>, <span class="st">'Closest_secondary'</span>, <span class="st">'Closest_tertiary'</span>, </span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">'road_width'</span>, <span class="st">'rate_BS'</span>, <span class="st">'POP2000'</span>,<span class="st">'Longitude'</span>, <span class="st">'Latitude'</span>, <span class="st">'MALES'</span>, <span class="st">'FEMALES'</span>,<span class="st">'AGE_UNDER5'</span>,<span class="st">'AGE_5_17'</span>,<span class="st">'AGE_18_21'</span>,<span class="st">'AGE_22_29'</span>,<span class="st">'AGE_30_39'</span>,<span class="st">'AGE_40_49'</span>,</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">'AGE_50_64'</span>,<span class="st">'AGE_65_UP'</span>,<span class="st">'MED_AGE'</span>,<span class="st">'MED_AGE_M'</span>,<span class="st">'MED_AGE_F'</span>,<span class="st">'HOUSEHOLDS'</span>,<span class="st">'AVE_HH_SZ'</span>,<span class="st">'HSEHLD_1_M'</span>,<span class="st">'HSEHLD_1_F'</span>,<span class="st">'MARHH_CHD'</span>,<span class="st">'MARHH_NO_C'</span>,<span class="st">'MHH_CHILD'</span>,<span class="st">'FHH_CHILD'</span>,<span class="st">'FAMILIES'</span>,</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>             <span class="st">'AVE_FAM_SZ'</span>,<span class="st">'HSE_UNITS'</span>,<span class="st">'VACANT'</span>,<span class="st">'OWNER_OCC'</span>,<span class="st">'RENTER_OCC'</span>,<span class="st">'rtype'</span>,<span class="st">'ztype'</span>]</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Categorical Features </span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>categorical <span class="op">=</span> [<span class="st">'Incident Day of Week'</span>, <span class="st">'Report Type Code'</span>, <span class="st">'Crime_Location'</span>,<span class="st">'gen'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>df_vs <span class="op">=</span> gpd_crime_fnl.copy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:7232,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682269569007,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="33b18e7e-859a-4d3a-88b3-f70ca0e5a9f6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>f, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span> [<span class="dv">20</span>,<span class="dv">15</span>])</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>sns.heatmap(df_vs[numerical].corr(), annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">".2f"</span>, ax<span class="op">=</span>ax, cmap <span class="op">=</span> <span class="st">"magma"</span> )</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"Correlation Matrix"</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="505Final_files/figure-html/cell-94-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:344,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682269676241,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="0294fe51-dd4d-4063-8bb7-e3a4238d0f63">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>Corr <span class="op">=</span> pd.DataFrame(df_vs[numerical].corr()[<span class="st">'Result'</span>].sort_values(ascending <span class="op">=</span> <span class="va">False</span>))</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>Corr <span class="op">=</span> Corr.iloc[<span class="dv">1</span>:,:]</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>Corr.columns <span class="op">=</span> [<span class="st">'Targer Correlation'</span>]</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>Corr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="93">

  <div id="df-6bd974fd-ad6c-4fc1-bb4c-59a1c258ea4e">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Targer Correlation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">minute</td>
<td>0.125436</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MED_AGE_M</td>
<td>0.103229</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MED_AGE</td>
<td>0.082230</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Longitude</td>
<td>0.082165</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ztype</td>
<td>0.080871</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Closest_primary</td>
<td>0.071255</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">VACANT</td>
<td>0.070051</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Latitude</td>
<td>0.059627</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MED_AGE_F</td>
<td>0.049638</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">road_width</td>
<td>0.039319</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">rtype</td>
<td>0.038533</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">HSEHLD_1_M</td>
<td>0.025309</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">RENTER_OCC</td>
<td>0.001603</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">day</td>
<td>-0.000748</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">AGE_18_21</td>
<td>-0.001998</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">hour</td>
<td>-0.005705</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">AGE_65_UP</td>
<td>-0.006762</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AVE_FAM_SZ</td>
<td>-0.012245</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">AGE_50_64</td>
<td>-0.017518</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AGE_40_49</td>
<td>-0.024185</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">HSE_UNITS</td>
<td>-0.026224</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">month</td>
<td>-0.026534</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Closest_highway</td>
<td>-0.026694</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MALES</td>
<td>-0.027852</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">HSEHLD_1_F</td>
<td>-0.028811</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">FHH_CHILD</td>
<td>-0.031284</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">HOUSEHOLDS</td>
<td>-0.034578</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AGE_5_17</td>
<td>-0.037363</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Neighborhoods</td>
<td>-0.037629</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MHH_CHILD</td>
<td>-0.041164</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MARHH_NO_C</td>
<td>-0.041853</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MARHH_CHD</td>
<td>-0.042327</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Supervisor District 2012</td>
<td>-0.042750</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AVE_HH_SZ</td>
<td>-0.044648</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">POP2000</td>
<td>-0.044909</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AGE_UNDER5</td>
<td>-0.047650</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">FAMILIES</td>
<td>-0.047962</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AGE_22_29</td>
<td>-0.054750</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Closest_tertiary</td>
<td>-0.056600</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">FEMALES</td>
<td>-0.060230</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">rate_BS</td>
<td>-0.065186</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AGE_30_39</td>
<td>-0.068832</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Closest_secondary</td>
<td>-0.070957</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">OWNER_OCC</td>
<td>-0.078604</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-6bd974fd-ad6c-4fc1-bb4c-59a1c258ea4e')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-6bd974fd-ad6c-4fc1-bb4c-59a1c258ea4e button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-6bd974fd-ad6c-4fc1-bb4c-59a1c258ea4e');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1730,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682269602776,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="4a6968cf-eb99-4910-ab31-0ecf3e82cfeb">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>g0 <span class="op">=</span> sns.barplot(x<span class="op">=</span><span class="st">"Targer Correlation"</span>, y<span class="op">=</span>Corr.index, data<span class="op">=</span>Corr)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>g0.figure.set_size_inches(<span class="dv">12</span>, <span class="dv">9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="505Final_files/figure-html/cell-96-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>gpd_crime_vs <span class="op">=</span> gpd_crime_fnl.copy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2824,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682269975640,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="ccad9dd9-1404-4d43-c594-89b65b469b6b">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">11</span>, <span class="dv">10</span>))</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>plt.scatter(gpd_crime_vs.Longitude, gpd_crime_vs.Latitude, s<span class="op">=</span><span class="dv">5</span>, c <span class="op">=</span> gpd_crime_vs.hour)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>plt.colorbar()<span class="op">;</span> plt.xlabel(<span class="st">'Longitude'</span>, fontsize<span class="op">=</span><span class="dv">18</span>)<span class="op">;</span> plt.ylabel(<span class="st">'Latitude'</span>, fontsize<span class="op">=</span><span class="dv">18</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="96">
<pre><code>Text(0, 0.5, 'Latitude')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="505Final_files/figure-html/cell-98-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:4243,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682270228442,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="fa9c061b-614f-47b0-f41e-746f7fa4dc5b">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">11</span>, <span class="dv">10</span>))</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>plt.scatter(gpd_crime_vs.Longitude, gpd_crime_vs.Latitude, s<span class="op">=</span><span class="dv">5</span>, c <span class="op">=</span> gpd_crime_vs.Result)</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>plt.colorbar()<span class="op">;</span> plt.xlabel(<span class="st">'Longitude'</span>, fontsize<span class="op">=</span><span class="dv">18</span>)<span class="op">;</span> plt.ylabel(<span class="st">'Latitude'</span>, fontsize<span class="op">=</span><span class="dv">18</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="98">
<pre><code>Text(0, 0.5, 'Latitude')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="505Final_files/figure-html/cell-99-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:4736,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682273167197,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="09d67e7d-a7fb-4155-8905-11b72907eff7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>_,axss <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">3</span>, figsize <span class="op">=</span> [<span class="dv">20</span>,<span class="dv">8</span>])</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>sns.countplot(x <span class="op">=</span> <span class="st">'Crime_Location'</span>, data <span class="op">=</span> gpd_crime_vs,ax<span class="op">=</span>axss[<span class="dv">0</span>][<span class="dv">0</span>])</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>sns.countplot(x <span class="op">=</span> <span class="st">'gen'</span>, data <span class="op">=</span> gpd_crime_vs,ax<span class="op">=</span>axss[<span class="dv">0</span>][<span class="dv">1</span>])</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>sns.countplot(x <span class="op">=</span> <span class="st">'Result'</span>, hue <span class="op">=</span> gpd_crime_vs[<span class="st">'gen'</span>], data <span class="op">=</span> gpd_crime_vs,ax<span class="op">=</span>axss[<span class="dv">0</span>][<span class="dv">2</span>])</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>sns.countplot(x <span class="op">=</span> <span class="st">'Result'</span>, hue <span class="op">=</span> gpd_crime_vs[<span class="st">'Crime_Location'</span>], data <span class="op">=</span> gpd_crime_vs,ax<span class="op">=</span>axss[<span class="dv">1</span>][<span class="dv">0</span>])</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>sns.countplot(x <span class="op">=</span> <span class="st">'Result'</span>, hue <span class="op">=</span> gpd_crime_vs[<span class="st">'Incident Day of Week'</span>], data <span class="op">=</span> gpd_crime_vs,ax<span class="op">=</span>axss[<span class="dv">1</span>][<span class="dv">1</span>])</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>sns.countplot(x <span class="op">=</span> <span class="st">'Result'</span>, hue <span class="op">=</span> gpd_crime_vs[<span class="st">'Incident Subcategory'</span>], data <span class="op">=</span> gpd_crime_vs,ax<span class="op">=</span>axss[<span class="dv">1</span>][<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="113">
<pre><code>&lt;Axes: xlabel='Result', ylabel='count'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="505Final_files/figure-html/cell-100-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2244,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682271016141,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="38a94fb6-3d62-4695-fd79-02e683e79eea">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>_,axss <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">3</span>, figsize <span class="op">=</span> [<span class="dv">20</span>,<span class="dv">10</span>])</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'Result'</span>,y<span class="op">=</span><span class="st">'AGE_30_39'</span>,data<span class="op">=</span>gpd_crime_vs,ax<span class="op">=</span>axss[<span class="dv">0</span>][<span class="dv">0</span>])</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'Result'</span>,y<span class="op">=</span><span class="st">'FEMALES'</span>,data<span class="op">=</span>gpd_crime_vs,ax<span class="op">=</span>axss[<span class="dv">0</span>][<span class="dv">1</span>])</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'Result'</span>,y<span class="op">=</span><span class="st">'AGE_22_29'</span>,data<span class="op">=</span>gpd_crime_vs,ax<span class="op">=</span>axss[<span class="dv">0</span>][<span class="dv">2</span>])</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'Result'</span>,y<span class="op">=</span><span class="st">'OWNER_OCC'</span>,data<span class="op">=</span>gpd_crime_vs,ax<span class="op">=</span>axss[<span class="dv">1</span>][<span class="dv">0</span>])</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'Result'</span>,y<span class="op">=</span><span class="st">'MED_AGE_M'</span>,data<span class="op">=</span>gpd_crime_vs,ax<span class="op">=</span>axss[<span class="dv">1</span>][<span class="dv">1</span>])</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'Result'</span>,y<span class="op">=</span><span class="st">'VACANT'</span>,data<span class="op">=</span>gpd_crime_vs,ax<span class="op">=</span>axss[<span class="dv">1</span>][<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="106">
<pre><code>&lt;Axes: xlabel='Result', ylabel='VACANT'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="505Final_files/figure-html/cell-101-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1244,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682271935263,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="534a8cd5-ccd2-4847-a9f5-6e03cc6c89f6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>_,axss <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">2</span>, figsize <span class="op">=</span> [<span class="dv">20</span>,<span class="dv">10</span>])</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'Result'</span>,y<span class="op">=</span><span class="st">'Closest_secondary'</span>,data<span class="op">=</span>gpd_crime_vs,ax<span class="op">=</span>axss[<span class="dv">0</span>][<span class="dv">0</span>])</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'Result'</span>,y<span class="op">=</span><span class="st">'Closest_tertiary'</span>,data<span class="op">=</span>gpd_crime_vs,ax<span class="op">=</span>axss[<span class="dv">0</span>][<span class="dv">1</span>])</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'Result'</span>,y<span class="op">=</span><span class="st">'Closest_primary'</span>,data<span class="op">=</span>gpd_crime_vs,ax<span class="op">=</span>axss[<span class="dv">1</span>][<span class="dv">0</span>])</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'Result'</span>,y<span class="op">=</span><span class="st">'road_width'</span>,data<span class="op">=</span>gpd_crime_vs,ax<span class="op">=</span>axss[<span class="dv">1</span>][<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="109">
<pre><code>&lt;Axes: xlabel='Result', ylabel='road_width'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="505Final_files/figure-html/cell-102-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>dropy <span class="op">=</span> [<span class="st">'Incident Time'</span>,<span class="st">'Incident Year'</span>,<span class="st">'Incident Day of Week'</span>,<span class="st">'Report Type Code'</span>,<span class="st">'Incident Category'</span>,<span class="st">'Incident Subcategory'</span>,<span class="st">'Resolution'</span>,<span class="st">'Intersection'</span>,<span class="st">'Police District'</span>,<span class="st">'Analysis Neighborhood'</span>,</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Supervisor District 2012'</span>,<span class="st">'Latitude'</span>,<span class="st">'Longitude'</span>,<span class="st">'Point'</span>,<span class="st">'ESNCAG - Boundary File'</span>,<span class="st">'geometry'</span>,<span class="st">'year'</span>,<span class="st">'minute'</span>,<span class="st">'place_id'</span>,<span class="st">'osm_type'</span>,<span class="st">'osm_id'</span>,<span class="st">'lat'</span>,<span class="st">'lon'</span>,<span class="st">'display_name'</span>,</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">'class'</span>,<span class="st">'type'</span>,<span class="st">'Crime_Location'</span>,<span class="st">'the_geom_left'</span>,<span class="st">'districtname'</span>,<span class="st">'gen'</span>,<span class="st">'index_right'</span>,<span class="st">'the_geom_right'</span>,<span class="st">'OBJECTID'</span>,<span class="st">'FIPSSTCO'</span>,<span class="st">'TRT2000'</span>,<span class="st">'STFID'</span>,<span class="st">'TRACTID'</span>,<span class="st">'STATE'</span>,<span class="st">'COUNTY'</span>,</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">'TRACT'</span>]</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>crime_md <span class="op">=</span> gpd_crime_fnl.drop(dropy, axis <span class="op">=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:113,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682273657907,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="01f98579-c9fb-4576-bf39-27e780d70147">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>crime_md.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="117">
<pre><code>Neighborhoods        float64
month                  int64
day                    int64
hour                   int64
Result                 int64
importance           float64
Closest_highway      float64
Closest_primary      float64
Closest_secondary    float64
Closest_tertiary     float64
builidng_nn1         float64
road_width             int64
rate_BS              float64
POP2000                int64
WHITE                  int64
BLACK                  int64
AMERI_ES               int64
ASIAN                  int64
HAWN_PI                int64
OTHER                  int64
MULT_RACE              int64
HISPANIC               int64
MALES                  int64
FEMALES                int64
AGE_UNDER5             int64
AGE_5_17               int64
AGE_18_21              int64
AGE_22_29              int64
AGE_30_39              int64
AGE_40_49              int64
AGE_50_64              int64
AGE_65_UP              int64
MED_AGE              float64
MED_AGE_M            float64
MED_AGE_F            float64
HOUSEHOLDS             int64
AVE_HH_SZ            float64
HSEHLD_1_M             int64
HSEHLD_1_F             int64
MARHH_CHD              int64
MARHH_NO_C             int64
MHH_CHILD              int64
FHH_CHILD              int64
FAMILIES               int64
AVE_FAM_SZ           float64
HSE_UNITS              int64
URBAN                  int64
RURAL                  int64
VACANT                 int64
OWNER_OCC              int64
RENTER_OCC             int64
rtype                  int64
ztype                  int64
dtype: object</code></pre>
</div>
</div>
</section>
<section id="model-construction" class="level1">
<h1>Model Construction</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>crime_md.fillna(<span class="dv">0</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> crime_md.drop([<span class="st">'Result'</span>],axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> crime_md[<span class="st">'Result'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682274006851,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="3b9381fb-d590-4f88-ea99-ca492da2dad5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> model_selection <span class="im">as</span> mdslct</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> mdslct.train_test_split(X, y, test_size <span class="op">=</span> <span class="fl">0.25</span>, stratify<span class="op">=</span> y, random_state<span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'training data has '</span> <span class="op">+</span> <span class="bu">str</span>(X_train.shape[<span class="dv">0</span>]) <span class="op">+</span> <span class="st">' observation with '</span> <span class="op">+</span> <span class="bu">str</span>(X_train.shape[<span class="dv">1</span>]) <span class="op">+</span> <span class="st">' features'</span>)</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'test data has '</span> <span class="op">+</span> <span class="bu">str</span>(X_test.shape[<span class="dv">0</span>]) <span class="op">+</span> <span class="st">' observation with '</span> <span class="op">+</span> <span class="bu">str</span>(X_test.shape[<span class="dv">1</span>]) <span class="op">+</span> <span class="st">' features'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>training data has 21165 observation with 52 features
test data has 7055 observation with 52 features</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>scale <span class="op">=</span> StandardScaler()</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>scale.fit(X_train)</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> scale.transform(X_train)</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> scale.transform(X_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier </span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>classifier_rd <span class="op">=</span> RandomForestClassifier()</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>classifier_KNN <span class="op">=</span> KNeighborsClassifier()</span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>classifier_lr <span class="op">=</span> LogisticRegression()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>classifier_rd.fit(X_train,y_train)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>classifier_rd.predict(X_test)</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>classifier_rd.score(X_test,y_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>classifier_KNN.fit(X_train,y_train)</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>classifier_KNN.predict(X_test)</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>classifier_KNN.score(X_test,y_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>classifier_lr.fit(X_train,y_train,sample_weight<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>classifier_lr.predict(X_test)</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>classifier_lr.score(X_test,y_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_grid_search_metrics(gs):</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">"best_score ="</span> <span class="op">+</span> <span class="bu">str</span>(gs.best_score_))</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">'best_parameter set:'</span>)</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>  best_parameter <span class="op">=</span> gs.best_params_</span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> param_name <span class="kw">in</span> <span class="bu">sorted</span>(best_parameter.keys()):</span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(param_name <span class="op">+</span> <span class="st">':'</span> <span class="op">+</span> <span class="bu">str</span>(best_parameter[param_name]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:507038,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682274677831,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="95700aa3-ba59-4bfe-8950-e861cbe208c4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co">#to find the optimal hyperparamater</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="co">#penalty is the way of regularization, C is the weight for penalty</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>parameters <span class="op">=</span> {</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'penalty'</span>:(<span class="st">'l2'</span>,<span class="st">'l1'</span>), </span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'C'</span>:(<span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="dv">1</span>,<span class="fl">1.1</span>,<span class="fl">1.2</span>)</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>Grid_LR <span class="op">=</span> GridSearchCV(LogisticRegression(solver<span class="op">=</span><span class="st">'liblinear'</span>),parameters, cv<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>Grid_LR.fit(X_train, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="132">
<style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GridSearchCV(cv=5, estimator=LogisticRegression(solver='liblinear'),
             param_grid={'C': (0.01, 0.05, 0.1, 0.2, 1, 1.1, 1.2),
                         'penalty': ('l2', 'l1')})</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox"><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">GridSearchCV</label><div class="sk-toggleable__content"><pre>GridSearchCV(cv=5, estimator=LogisticRegression(solver='liblinear'),
             param_grid={'C': (0.01, 0.05, 0.1, 0.2, 1, 1.1, 1.2),
                         'penalty': ('l2', 'l1')})</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox"><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">estimator: LogisticRegression</label><div class="sk-toggleable__content"><pre>LogisticRegression(solver='liblinear')</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox"><label for="sk-estimator-id-3" class="sk-toggleable__label sk-toggleable__label-arrow">LogisticRegression</label><div class="sk-toggleable__content"><pre>LogisticRegression(solver='liblinear')</pre></div></div></div></div></div></div></div></div></div></div>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:339,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682275207459,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="ed91edc5-26e7-4e45-a393-fe4c2c70ccaf">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(print_grid_search_metrics(Grid_LR))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>best_score =0.9539333805811481
best_parameter set:
C:0.01
penalty:l2
None</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>best_LR_model <span class="op">=</span> Grid_LR.best_estimator_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:162,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682275259723,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="c7cd8d94-156a-44e8-b267-09b8cc44b961">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>best_LR_model.predict(X_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="135">
<pre><code>array([0, 0, 0, ..., 0, 0, 0])</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:315,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682275260877,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="de45691f-5ef2-4a79-b24c-2ce10611f2a0">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>best_LR_model.score(X_test,y_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="136">
<pre><code>0.9539333805811481</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:15007,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682275453334,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="d81dccb8-f5e4-4f86-d407-ca7b60f37d03">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># optimal hyperparameter for KNN</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>parameters <span class="op">=</span> {</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n_neighbors'</span>:[<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>]</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>} <span class="co">#the name of parameters should match that in KNN</span></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>Grid_KNN <span class="op">=</span> GridSearchCV(KNeighborsClassifier(),parameters,cv<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>Grid_KNN.fit(X_train, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="138">
<style>#sk-container-id-2 {color: black;background-color: white;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GridSearchCV(cv=5, estimator=KNeighborsClassifier(),
             param_grid={'n_neighbors': [1, 3, 5, 7]})</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-4" type="checkbox"><label for="sk-estimator-id-4" class="sk-toggleable__label sk-toggleable__label-arrow">GridSearchCV</label><div class="sk-toggleable__content"><pre>GridSearchCV(cv=5, estimator=KNeighborsClassifier(),
             param_grid={'n_neighbors': [1, 3, 5, 7]})</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-5" type="checkbox"><label for="sk-estimator-id-5" class="sk-toggleable__label sk-toggleable__label-arrow">estimator: KNeighborsClassifier</label><div class="sk-toggleable__content"><pre>KNeighborsClassifier()</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-6" type="checkbox"><label for="sk-estimator-id-6" class="sk-toggleable__label sk-toggleable__label-arrow">KNeighborsClassifier</label><div class="sk-toggleable__content"><pre>KNeighborsClassifier()</pre></div></div></div></div></div></div></div></div></div></div>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:408,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682275459504,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="45a6b1cb-56ff-4077-be48-b29e17e1141f">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(print_grid_search_metrics(Grid_KNN))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>best_score =0.9526104417670682
best_parameter set:
n_neighbors:7
None</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>best_KNN_model <span class="op">=</span> Grid_KNN.best_estimator_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:906,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682275466485,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="5abff355-a171-4f3f-df01-bc8cda9016d6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>best_KNN_model.predict(X_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="141">
<pre><code>array([0, 0, 0, ..., 0, 0, 0])</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1514,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682275468953,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="3134b19a-63ed-4afb-fc6f-e0ad75ef560d">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>best_KNN_model.score(X_test,y_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="142">
<pre><code>0.9523742026931254</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:94864,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682275594169,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="e7bc3b95-91fb-486d-db61-fa433b03da35">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># optimal hyperparameter for Random Forest</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>parameters <span class="op">=</span> {</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n_estimators'</span> : [<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">80</span>,<span class="dv">100</span>],</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_depth'</span>: [<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">10</span>]</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>Grid_RM <span class="op">=</span> GridSearchCV(RandomForestClassifier(),parameters,cv<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>Grid_RM.fit(X_train,y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="143">
<style>#sk-container-id-3 {color: black;background-color: white;}#sk-container-id-3 pre{padding: 0;}#sk-container-id-3 div.sk-toggleable {background-color: white;}#sk-container-id-3 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-3 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-3 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-3 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-3 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-3 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-3 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-3 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-3 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-3 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-3 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-3 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-3 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-3 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-3 div.sk-item {position: relative;z-index: 1;}#sk-container-id-3 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-3 div.sk-item::before, #sk-container-id-3 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-3 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-3 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-3 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-3 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-3 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-3 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-3 div.sk-label-container {text-align: center;}#sk-container-id-3 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-3 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-3" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GridSearchCV(cv=5, estimator=RandomForestClassifier(),
             param_grid={'max_depth': [1, 5, 8, 10],
                         'n_estimators': [50, 60, 80, 100]})</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-7" type="checkbox"><label for="sk-estimator-id-7" class="sk-toggleable__label sk-toggleable__label-arrow">GridSearchCV</label><div class="sk-toggleable__content"><pre>GridSearchCV(cv=5, estimator=RandomForestClassifier(),
             param_grid={'max_depth': [1, 5, 8, 10],
                         'n_estimators': [50, 60, 80, 100]})</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-8" type="checkbox"><label for="sk-estimator-id-8" class="sk-toggleable__label sk-toggleable__label-arrow">estimator: RandomForestClassifier</label><div class="sk-toggleable__content"><pre>RandomForestClassifier()</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-9" type="checkbox"><label for="sk-estimator-id-9" class="sk-toggleable__label sk-toggleable__label-arrow">RandomForestClassifier</label><div class="sk-toggleable__content"><pre>RandomForestClassifier()</pre></div></div></div></div></div></div></div></div></div></div>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:138,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682275596543,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="65b32c30-549e-4fd9-a476-65904e9c576e">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(print_grid_search_metrics(Grid_RM))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>best_score =0.9581384360973304
best_parameter set:
max_depth:10
n_estimators:80
None</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>best_RM_model <span class="op">=</span> Grid_RM.best_estimator_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:193,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682275600436,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="3a10759b-a5f5-44ac-d1a9-e0f9e36de79f">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>best_RM_model.predict(X_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="146">
<pre><code>array([0, 0, 0, ..., 0, 0, 0])</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:178,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682275601687,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="41558baa-a2fd-4b99-bc50-87c6815aa8cf">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>best_RM_model.score(X_test,y_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="147">
<pre><code>0.9587526576895818</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> precision_score</span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> recall_score</span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate accuracy, precision and recall, [[tn, fp],[]]</span></span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cal_evaluation(classifier, cm):</span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>    tn <span class="op">=</span> cm[<span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a>    fp <span class="op">=</span> cm[<span class="dv">0</span>][<span class="dv">1</span>]</span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a>    fn <span class="op">=</span> cm[<span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb157-11"><a href="#cb157-11" aria-hidden="true" tabindex="-1"></a>    tp <span class="op">=</span> cm[<span class="dv">1</span>][<span class="dv">1</span>]</span>
<span id="cb157-12"><a href="#cb157-12" aria-hidden="true" tabindex="-1"></a>    accuracy <span class="op">=</span> (tp<span class="op">+</span> tn)<span class="op">/</span>(tp <span class="op">+</span> tn <span class="op">+</span> fp <span class="op">+</span> fn <span class="op">+</span> <span class="fl">0.0</span>)</span>
<span id="cb157-13"><a href="#cb157-13" aria-hidden="true" tabindex="-1"></a>    precision <span class="op">=</span> tp<span class="op">/</span>(tp <span class="op">+</span> fp <span class="op">+</span> <span class="fl">0.0</span>)</span>
<span id="cb157-14"><a href="#cb157-14" aria-hidden="true" tabindex="-1"></a>    recall <span class="op">=</span> tp<span class="op">/</span>(tp <span class="op">+</span> fn <span class="op">+</span> <span class="fl">0.0</span>)</span>
<span id="cb157-15"><a href="#cb157-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span> (classifier)</span>
<span id="cb157-16"><a href="#cb157-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span> (<span class="st">"Accuracy is: "</span> <span class="op">+</span> <span class="bu">str</span>(accuracy))</span>
<span id="cb157-17"><a href="#cb157-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span> (<span class="st">"precision is: "</span> <span class="op">+</span> <span class="bu">str</span>(precision))</span>
<span id="cb157-18"><a href="#cb157-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span> (<span class="st">"recall is: "</span> <span class="op">+</span> <span class="bu">str</span>(recall))</span>
<span id="cb157-19"><a href="#cb157-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span> ()</span>
<span id="cb157-20"><a href="#cb157-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-21"><a href="#cb157-21" aria-hidden="true" tabindex="-1"></a><span class="co"># print out confusion matrices</span></span>
<span id="cb157-22"><a href="#cb157-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> draw_confusion_matrices(confusion_matricies):</span>
<span id="cb157-23"><a href="#cb157-23" aria-hidden="true" tabindex="-1"></a>    class_names <span class="op">=</span> [<span class="st">'Not'</span>,<span class="st">'Churn'</span>]</span>
<span id="cb157-24"><a href="#cb157-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> cm <span class="kw">in</span> confusion_matrices:</span>
<span id="cb157-25"><a href="#cb157-25" aria-hidden="true" tabindex="-1"></a>        classifier, cm <span class="op">=</span> cm[<span class="dv">0</span>], cm[<span class="dv">1</span>]</span>
<span id="cb157-26"><a href="#cb157-26" aria-hidden="true" tabindex="-1"></a>        cal_evaluation(classifier, cm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1449,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682275608798,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="f96df3d5-6cb4-4481-fad8-47fb744fd779">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>confusion_matrices <span class="op">=</span> [</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"Random Forest"</span>, confusion_matrix(y_test,best_RM_model.predict(X_test))),</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"Logistic Regression"</span>, confusion_matrix(y_test,best_LR_model.predict(X_test))),</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"K nearest neighbor"</span>, confusion_matrix(y_test, best_KNN_model.predict(X_test)))</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>draw_confusion_matrices(confusion_matrices)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Random Forest
Accuracy is: 0.9587526576895818
precision is: 0.7931034482758621
recall is: 0.14153846153846153

Logistic Regression
Accuracy is: 0.9539333805811481
precision is: nan
recall is: 0.0

K nearest neighbor
Accuracy is: 0.9523742026931254
precision is: 0.44554455445544555
recall is: 0.13846153846153847
</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>RuntimeWarning: invalid value encountered in true_divide
  precision = tp/(tp + fp + 0.0)</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> roc_curve</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> metrics</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a><span class="co">#ROC for Random Forest</span></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>y_pred_rm <span class="op">=</span> best_RM_model.predict_proba(X_test)[:, <span class="dv">1</span>]</span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>fpr_rf, tpr_rf, _ <span class="op">=</span> roc_curve(y_test, y_pred_rm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:367,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682275639535,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="61a5b7c9-e3de-455c-f85a-6368ca278399">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>best_RM_model.predict_proba(X_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="150">
<pre><code>array([[0.9804783 , 0.0195217 ],
       [0.96240263, 0.03759737],
       [0.98051001, 0.01948999],
       ...,
       [0.93483543, 0.06516457],
       [0.97694558, 0.02305442],
       [0.97324386, 0.02675614]])</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:521,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682278213002,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="0eb183bd-6f0e-4b9c-a40c-661ae37b72b7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ROC curve of Random Forest result</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>plt.figure(<span class="dv">1</span>)</span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>plt.plot([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">0</span>, <span class="dv">1</span>], <span class="st">'k--'</span>)</span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>plt.plot(fpr_rf, tpr_rf, label<span class="op">=</span><span class="st">'RF'</span>)</span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'False positive rate'</span>)</span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'True positive rate'</span>)</span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'ROC curve - RF model'</span>)</span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">'best'</span>)</span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="505Final_files/figure-html/cell-133-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:808,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682275665637,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="703ae602-ab9b-4834-9842-06695b88e12c">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> metrics</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="co"># AUC score</span></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>metrics.auc(fpr_rf,tpr_rf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="152">
<pre><code>0.7818637558578123</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ROC for Logistic Regression </span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>y_pred_lr <span class="op">=</span> best_LR_model.predict_proba(X_test)[:, <span class="dv">1</span>]</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>fpr_rf, tpr_rf, _ <span class="op">=</span> roc_curve(y_test, y_pred_lr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:125,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682275691493,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="eaa7806d-9f7d-48a6-c0a3-abd020a27590">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>best_LR_model.predict_proba(X_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="154">
<pre><code>array([[0.96862073, 0.03137927],
       [0.96606054, 0.03393946],
       [0.95716253, 0.04283747],
       ...,
       [0.94351064, 0.05648936],
       [0.92430863, 0.07569137],
       [0.92842141, 0.07157859]])</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:721,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682275698928,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="550515dd-3b11-49ac-8bd7-15a90f083afe">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>plt.figure(<span class="dv">1</span>)</span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>plt.plot([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">0</span>, <span class="dv">1</span>], <span class="st">'k--'</span>)</span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>plt.plot(fpr_rf, tpr_rf, label<span class="op">=</span><span class="st">'RF'</span>)</span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'False positive rate'</span>)</span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'True positive rate'</span>)</span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'ROC curve - LR model'</span>)</span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">'best'</span>)</span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="505Final_files/figure-html/cell-137-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:142,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682275708192,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="1968bf62-b94e-4d3d-af3e-976e27e2e927">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>metrics.auc(fpr_rf,tpr_rf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="156">
<pre><code>0.7121924791404731</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:595,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682275901790,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="36274dce-f434-4a05-9e2e-45f8ff54615f">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>x_corr <span class="op">=</span> X.copy()</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>X_L1 <span class="op">=</span> scaler.fit_transform(x_corr)</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>LRmodel_l1 <span class="op">=</span> LogisticRegression(penalty<span class="op">=</span><span class="st">"l1"</span>, C <span class="op">=</span> <span class="fl">0.04</span>, solver<span class="op">=</span><span class="st">'liblinear'</span>)</span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>LRmodel_l1.fit(X_L1,y)</span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a>indices <span class="op">=</span> np.argsort(<span class="bu">abs</span>(LRmodel_l1.coef_[<span class="dv">0</span>]))[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb173-8"><a href="#cb173-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-9"><a href="#cb173-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (<span class="st">"Logistic Regression (L1) Coefficients"</span>)</span>
<span id="cb173-10"><a href="#cb173-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ind <span class="kw">in</span> <span class="bu">range</span>(x_corr.shape[<span class="dv">1</span>]):</span>
<span id="cb173-11"><a href="#cb173-11" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span> (<span class="st">"</span><span class="sc">{0}</span><span class="st"> : </span><span class="sc">{1}</span><span class="st">"</span>.<span class="bu">format</span>(x_corr.columns[indices[ind]],<span class="bu">round</span>(LRmodel_l1.coef_[<span class="dv">0</span>][indices[ind]], <span class="dv">4</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Logistic Regression (L1) Coefficients
MED_AGE_M : 0.3342
WHITE : -0.2047
Closest_secondary : -0.2016
Closest_primary : 0.1925
Closest_tertiary : -0.1874
rate_BS : -0.1429
ztype : 0.123
HAWN_PI : 0.1183
AGE_18_21 : 0.1173
OTHER : 0.1098
VACANT : 0.1073
ASIAN : 0.0678
AGE_65_UP : -0.0657
month : -0.0526
hour : -0.0477
OWNER_OCC : -0.0447
HSEHLD_1_F : -0.0366
Neighborhoods : -0.0362
MULT_RACE : -0.0351
HSEHLD_1_M : -0.0249
Closest_highway : 0.0211
rtype : 0.0193
BLACK : -0.0161
RENTER_OCC : 0.0
importance : 0.0
builidng_nn1 : 0.0
road_width : 0.0
RURAL : 0.0
POP2000 : 0.0
URBAN : 0.0
AMERI_ES : 0.0
day : 0.0
HSE_UNITS : 0.0
FAMILIES : 0.0
HISPANIC : 0.0
FHH_CHILD : 0.0
MHH_CHILD : 0.0
MARHH_NO_C : 0.0
MARHH_CHD : 0.0
AVE_HH_SZ : 0.0
HOUSEHOLDS : 0.0
MED_AGE_F : 0.0
AVE_FAM_SZ : 0.0
MED_AGE : 0.0
AGE_50_64 : 0.0
AGE_40_49 : 0.0
AGE_30_39 : 0.0
AGE_22_29 : 0.0
AGE_5_17 : 0.0
AGE_UNDER5 : 0.0
FEMALES : 0.0
MALES : 0.0</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1009,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682276025071,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="cdb8e4e4-6e99-4a1c-bea0-0b812f85d90f">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>X_L2 <span class="op">=</span> scaler.fit_transform(x_corr)</span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>LRmodel_l2 <span class="op">=</span> LogisticRegression(penalty<span class="op">=</span><span class="st">"l2"</span>, C <span class="op">=</span> <span class="fl">0.04</span>, solver<span class="op">=</span><span class="st">'liblinear'</span>)</span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a>LRmodel_l2.fit(X_L2,y)</span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a>indices <span class="op">=</span> np.argsort(<span class="bu">abs</span>(LRmodel_l2.coef_[<span class="dv">0</span>]))[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (<span class="st">"Logistic Regression (L2) Coefficients"</span>)</span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ind <span class="kw">in</span> <span class="bu">range</span>(x_corr.shape[<span class="dv">1</span>]):</span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span> (<span class="st">"</span><span class="sc">{0}</span><span class="st"> : </span><span class="sc">{1}</span><span class="st">"</span>.<span class="bu">format</span>(x_corr.columns[indices[ind]],<span class="bu">round</span>(LRmodel_l2.coef_[<span class="dv">0</span>][indices[ind]], <span class="dv">4</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Logistic Regression (L2) Coefficients
MED_AGE_M : 0.3263
HSEHLD_1_M : -0.2878
WHITE : -0.2381
AGE_5_17 : -0.2108
rate_BS : -0.2069
Closest_secondary : -0.2057
ASIAN : 0.196
MARHH_NO_C : 0.1924
Closest_primary : 0.1819
HAWN_PI : 0.1792
Closest_tertiary : -0.1763
AVE_HH_SZ : -0.1724
VACANT : 0.1557
AVE_FAM_SZ : 0.1522
AGE_65_UP : -0.1417
OTHER : 0.1396
MARHH_CHD : -0.1302
AGE_UNDER5 : 0.1262
AGE_18_21 : 0.1249
MULT_RACE : -0.1247
HISPANIC : 0.121
ztype : 0.1203
AGE_40_49 : 0.1187
MHH_CHILD : -0.1183
HSEHLD_1_F : -0.1088
AMERI_ES : 0.0906
AGE_50_64 : -0.0891
Closest_highway : 0.0882
road_width : -0.0823
MED_AGE : 0.0727
hour : -0.0718
MED_AGE_F : -0.067
month : -0.0657
HSE_UNITS : 0.0609
RENTER_OCC : 0.059
Neighborhoods : -0.0553
FHH_CHILD : 0.0535
HOUSEHOLDS : 0.0487
rtype : 0.0418
AGE_22_29 : 0.0297
AGE_30_39 : 0.0292
MALES : -0.0243
POP2000 : -0.0209
OWNER_OCC : -0.0185
FEMALES : -0.0151
BLACK : 0.015
FAMILIES : -0.0093
day : -0.0067
builidng_nn1 : -0.0
URBAN : 0.0
RURAL : 0.0
importance : 0.0</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:5944,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1682276084868,&quot;user&quot;:{&quot;displayName&quot;:&quot;Tianxiao Chen&quot;,&quot;userId&quot;:&quot;00991403131991230049&quot;},&quot;user_tz&quot;:240}" data-outputid="d91f0a4c-673b-43f4-e5cc-82616b4bea41">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check feature importance of random forest for feature selection</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>forest <span class="op">=</span> RandomForestClassifier()</span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>forest.fit(x_corr, y)</span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>importances <span class="op">=</span> forest.feature_importances_</span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a>indices <span class="op">=</span> np.argsort(importances)[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb177-8"><a href="#cb177-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-9"><a href="#cb177-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the feature ranking</span></span>
<span id="cb177-10"><a href="#cb177-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Feature importance ranking by Random Forest Model:"</span>)</span>
<span id="cb177-11"><a href="#cb177-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ind <span class="kw">in</span> <span class="bu">range</span>(X.shape[<span class="dv">1</span>]):</span>
<span id="cb177-12"><a href="#cb177-12" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span> (<span class="st">"</span><span class="sc">{0}</span><span class="st"> : </span><span class="sc">{1}</span><span class="st">"</span>.<span class="bu">format</span>(x_corr.columns[indices[ind]],<span class="bu">round</span>(importances[indices[ind]], <span class="dv">4</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Feature importance ranking by Random Forest Model:
day : 0.221
hour : 0.2031
month : 0.1718
Closest_primary : 0.0668
Closest_tertiary : 0.0593
Closest_secondary : 0.0564
Closest_highway : 0.0555
Neighborhoods : 0.0167
ztype : 0.0133
MED_AGE : 0.0076
rate_BS : 0.0076
road_width : 0.0074
MED_AGE_M : 0.0072
rtype : 0.0066
OWNER_OCC : 0.0053
VACANT : 0.0042
MULT_RACE : 0.004
ASIAN : 0.0037
MED_AGE_F : 0.0036
FEMALES : 0.0036
AGE_22_29 : 0.0036
AMERI_ES : 0.0035
AGE_40_49 : 0.0032
HSEHLD_1_M : 0.0031
MALES : 0.0031
POP2000 : 0.003
HISPANIC : 0.003
AGE_UNDER5 : 0.0029
HSEHLD_1_F : 0.0029
FAMILIES : 0.0029
BLACK : 0.0028
RENTER_OCC : 0.0028
HSE_UNITS : 0.0028
MARHH_NO_C : 0.0027
AGE_18_21 : 0.0026
HOUSEHOLDS : 0.0026
AGE_65_UP : 0.0026
AGE_50_64 : 0.0026
WHITE : 0.0025
OTHER : 0.0025
MARHH_CHD : 0.0025
AGE_5_17 : 0.0025
FHH_CHILD : 0.0024
AGE_30_39 : 0.0024
MHH_CHILD : 0.0023
AVE_HH_SZ : 0.0021
HAWN_PI : 0.0021
AVE_FAM_SZ : 0.0017
builidng_nn1 : 0.0
URBAN : 0.0
RURAL : 0.0
importance : 0.0</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>